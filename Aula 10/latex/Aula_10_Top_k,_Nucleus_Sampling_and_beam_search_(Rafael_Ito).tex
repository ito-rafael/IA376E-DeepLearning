\documentclass[10pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for grffile with XeLaTeX
    \def\Gread@@xetex#1{%
      \IfFileExists{"\Gin@base".bb}%
      {\Gread@eps{\Gin@base.bb}}%
      {\Gread@@xetex@aux#1}%
    }
    \makeatother

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Aula\_10\_Top\_k,\_Nucleus\_Sampling\_and\_beam\_search\_(Rafael\_Ito)}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        \ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{top-k-nucleus-sampling-and-beam-search-decoding-strategies}{%
\section*{Top-k, Nucleus Sampling and beam-search decoding
strategies}\label{top-k-nucleus-sampling-and-beam-search-decoding-strategies}}

    Author: \textbf{Rafael Ito}\\
e-mail: ito.rafael@gmail.com

    \hypertarget{dataset-and-description}{%
\section*{0. Dataset and Description}\label{dataset-and-description}}

\textbf{Name:} ParaCrawl corpus\\
\textbf{Description:} in this notebook we will implement three decoding
strategies: - Top-k - Nucleus Sampling - beam-search

We will use the T5 model with translation tasks to compare if the
decoder is implemented right.

    \hypertarget{libraries-and-packages}{%
\section*{1. Libraries and packages}\label{libraries-and-packages}}

    \hypertarget{check-device}{%
\subsection*{1.1 Check device}\label{check-device}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{torch}
\PY{n}{device} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{device}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cpu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{if} \PY{n}{torch}\PY{o}{.}\PY{n}{cuda}\PY{o}{.}\PY{n}{is\PYZus{}available}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{device\PYZus{}model} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cuda}\PY{o}{.}\PY{n}{get\PYZus{}device\PYZus{}name}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GPU model:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{device\PYZus{}model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
GPU model: Tesla P100-PCIE-16GB
    \end{Verbatim}

    \hypertarget{install-packages}{%
\subsection*{1.2 Install packages}\label{install-packages}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{o}{!}pip install \PYZhy{}q \PY{err}{\PYZbs{}}
    \PY{n}{numpy}       \PYZbs{}
    \PY{n}{torch}       \PYZbs{}
    \PY{n}{sklearn}     \PYZbs{}
    \PY{n}{skorch}      \PYZbs{}
    \PY{n}{matplotlib}  \PYZbs{}
    \PY{n}{sacrebleu}   \PYZbs{}
    \PY{n}{transformers}        \PYZbs{}
    \PY{n}{pytorch}\PY{o}{\PYZhy{}}\PY{n}{lightning}   \PYZbs{}
\end{Verbatim}
\end{tcolorbox}

    Install apex lib (16-bit precision)

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} to use 16\PYZhy{}bit precision, apex lib should be installed}
\PY{c+c1}{\PYZsh{} however, installing it with pip (\PYZsq{}! pip install \PYZhy{}q apex\PYZsq{}) crash the code}
\PY{c+c1}{\PYZsh{} installing the /}
\PY{o}{!} git clone \PYZhy{}q https://www.github.com/nvidia/apex
\PY{o}{!} pip \PYZhy{}q install \PYZhy{}v \PYZhy{}\PYZhy{}no\PYZhy{}cache\PYZhy{}dir /content/apex/
\PY{c+c1}{\PYZsh{}! pip install \PYZhy{}q \PYZhy{}v \PYZhy{}\PYZhy{}no\PYZhy{}cache\PYZhy{}dir \PYZhy{}\PYZhy{}global\PYZhy{}option=\PYZdq{}\PYZhy{}\PYZhy{}cpp\PYZus{}ext\PYZdq{} \PYZhy{}\PYZhy{}global\PYZhy{}option=\PYZdq{}\PYZhy{}\PYZhy{}cuda\PYZus{}ext\PYZdq{} /content/apex/}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
fatal: destination path 'apex' already exists and is not an empty directory.
Processing ./apex
Building wheels for collected packages: apex
  Building wheel for apex (setup.py) {\ldots} done
  Created wheel for apex: filename=apex-0.1-cp36-none-any.whl size=177174
sha256=afbdfac66a8bef0a078de80f7b4809df26d8bbd9ab5c4c669813804d305707dd
  Stored in directory: /tmp/pip-ephem-wheel-cache-
gpt3ljae/wheels/b1/3a/aa/d84906eaab780ae580c7a5686a33bf2820d8590ac3b60d5967
Successfully built apex
Installing collected packages: apex
  Found existing installation: apex 0.1
    Uninstalling apex-0.1:
      Successfully uninstalled apex-0.1
Successfully installed apex-0.1
    \end{Verbatim}

    \hypertarget{import-libraries}{%
\subsection*{1.3 Import libraries}\label{import-libraries}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} general}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{sys}
\PY{k+kn}{import} \PY{n+nn}{pdb}
\PY{k+kn}{import} \PY{n+nn}{random}
\PY{k+kn}{import} \PY{n+nn}{gzip}
\PY{k+kn}{import} \PY{n+nn}{itertools}
\PY{k+kn}{import} \PY{n+nn}{collections}
\PY{k+kn}{from} \PY{n+nn}{google}\PY{n+nn}{.}\PY{n+nn}{colab} \PY{k+kn}{import} \PY{n}{drive}
\PY{k+kn}{from} \PY{n+nn}{argparse} \PY{k+kn}{import} \PY{n}{Namespace}
\PY{k+kn}{from} \PY{n+nn}{typing} \PY{k+kn}{import} \PY{n}{Dict}\PY{p}{,} \PY{n}{List}\PY{p}{,} \PY{n}{Tuple}
\PY{k+kn}{import} \PY{n+nn}{functools}\PY{o}{,} \PY{n+nn}{traceback}
\PY{k+kn}{import} \PY{n+nn}{tensorboard}
\PY{o}{\PYZpc{}}\PY{k}{load\PYZus{}ext} tensorboard
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} HW status}
\PY{k+kn}{import} \PY{n+nn}{psutil}
\PY{k+kn}{import} \PY{n+nn}{nvidia\PYZus{}smi}
\PY{k+kn}{from} \PY{n+nn}{multiprocessing} \PY{k+kn}{import} \PY{n}{cpu\PYZus{}count}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{nvidia\PYZus{}smi}\PY{o}{.}\PY{n}{nvmlInit}\PY{p}{(}\PY{p}{)}
\PY{n}{handle} \PY{o}{=} \PY{n}{nvidia\PYZus{}smi}\PY{o}{.}\PY{n}{nvmlDeviceGetHandleByIndex}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} NLP}
\PY{k+kn}{import} \PY{n+nn}{re}
\PY{k+kn}{import} \PY{n+nn}{nltk}
\PY{k+kn}{import} \PY{n+nn}{sacrebleu}
\PY{k+kn}{from} \PY{n+nn}{transformers} \PY{k+kn}{import} \PY{n}{T5ForConditionalGeneration}\PY{p}{,} \PY{n}{T5Tokenizer}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} PyTorch}
\PY{k+kn}{import} \PY{n+nn}{torch}
\PY{k+kn}{from} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{nn} \PY{k+kn}{import} \PY{n}{CrossEntropyLoss}\PY{p}{,} \PY{n}{MSELoss}
\PY{k+kn}{from} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{nn} \PY{k+kn}{import} \PY{n}{Linear}
\PY{k+kn}{from} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{optim} \PY{k+kn}{import} \PY{n}{Adam}\PY{p}{,} \PY{n}{SGD}
\PY{k+kn}{from} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{optim}\PY{n+nn}{.}\PY{n+nn}{lr\PYZus{}scheduler} \PY{k+kn}{import} \PY{n}{StepLR}
\PY{k+kn}{from} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{utils}\PY{n+nn}{.}\PY{n+nn}{data} \PY{k+kn}{import} \PY{n}{TensorDataset}\PY{p}{,} \PY{n}{Dataset}\PY{p}{,} \PY{n}{DataLoader}
\PY{k+kn}{import} \PY{n+nn}{torch}\PY{n+nn}{.}\PY{n+nn}{nn}\PY{n+nn}{.}\PY{n+nn}{functional} \PY{k}{as} \PY{n+nn}{F}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} PyTorch Lightning}
\PY{k+kn}{import} \PY{n+nn}{pytorch\PYZus{}lightning} \PY{k}{as} \PY{n+nn}{pl}
\PY{k+kn}{from} \PY{n+nn}{pytorch\PYZus{}lightning}\PY{n+nn}{.}\PY{n+nn}{callbacks} \PY{k+kn}{import} \PY{n}{EarlyStopping}\PY{p}{,} \PY{n}{ModelCheckpoint}
\PY{k+kn}{from} \PY{n+nn}{pytorch\PYZus{}lightning}\PY{n+nn}{.}\PY{n+nn}{loggers} \PY{k+kn}{import} \PY{n}{TensorBoardLogger}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} random seed generator}
\PY{n}{seed} \PY{o}{=} \PY{l+m+mi}{42}
\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{seed}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
\PY{n}{torch}\PY{o}{.}\PY{n}{manual\PYZus{}seed}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
\PY{n}{torch}\PY{o}{.}\PY{n}{cuda}\PY{o}{.}\PY{n}{manual\PYZus{}seed}\PY{p}{(}\PY{n}{seed}\PY{p}{)}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} Suppress some of the logging}
\PY{c+c1}{\PYZsh{} commands got from Diedre\PYZsq{}s notebook}
\PY{k+kn}{import} \PY{n+nn}{logging}
\PY{n}{logging}\PY{o}{.}\PY{n}{getLogger}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transformers.configuration\PYZus{}utils}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{setLevel}\PY{p}{(}\PY{n}{logging}\PY{o}{.}\PY{n}{WARNING}\PY{p}{)}
\PY{n}{logging}\PY{o}{.}\PY{n}{getLogger}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transformers.modeling\PYZus{}utils}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{setLevel}\PY{p}{(}\PY{n}{logging}\PY{o}{.}\PY{n}{WARNING}\PY{p}{)}
\PY{n}{logging}\PY{o}{.}\PY{n}{getLogger}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{transformers.tokenization\PYZus{}utils}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{setLevel}\PY{p}{(}\PY{n}{logging}\PY{o}{.}\PY{n}{WARNING}\PY{p}{)}
\PY{n}{logging}\PY{o}{.}\PY{n}{getLogger}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lightning}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{o}{.}\PY{n}{setLevel}\PY{p}{(}\PY{n}{logging}\PY{o}{.}\PY{n}{WARNING}\PY{p}{)}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} package version}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Torch version:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{torch}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Pytorch Lightning version:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pl}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Torch version: 1.5.0+cu101
Pytorch Lightning version: 0.7.6
    \end{Verbatim}

    \hypertarget{device-info}{%
\subsection*{1.4 Device info}\label{device-info}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{torch}
\PY{n}{device} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{device}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cpu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{if} \PY{n}{torch}\PY{o}{.}\PY{n}{cuda}\PY{o}{.}\PY{n}{is\PYZus{}available}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{device} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{device}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cuda}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{device\PYZus{}model} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cuda}\PY{o}{.}\PY{n}{get\PYZus{}device\PYZus{}name}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{n}{device\PYZus{}memory} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cuda}\PY{o}{.}\PY{n}{get\PYZus{}device\PYZus{}properties}\PY{p}{(}\PY{n}{device}\PY{p}{)}\PY{o}{.}\PY{n}{total\PYZus{}memory} \PY{o}{/} \PY{l+m+mf}{1e9}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Device:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{device}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GPU model:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{device\PYZus{}model}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GPU memory: }\PY{l+s+si}{\PYZob{}0:.2f\PYZcb{}}\PY{l+s+s1}{ GB}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{device\PYZus{}memory}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CPU cores:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cpu\PYZus{}count}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Device: cuda
GPU model: Tesla P100-PCIE-16GB
GPU memory: 17.07 GB
\#-------------------
CPU cores: 4
    \end{Verbatim}

    \hypertarget{mount-google-drive}{%
\subsection*{1.5 Mount Google Drive}\label{mount-google-drive}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} mount Drive to save checkpoints and continue the training from last stop}
\PY{n}{drive}\PY{o}{.}\PY{n}{mount}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/content/drive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Drive already mounted at /content/drive; to attempt to forcibly remount, call
drive.mount("/content/drive", force\_remount=True).
    \end{Verbatim}

    \hypertarget{constants-definition}{%
\subsection*{1.6 Constants definition}\label{constants-definition}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} initial config}
\PY{n}{model\PYZus{}name} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t5\PYZhy{}small}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{128}
\PY{n}{accumulate\PYZus{}grad\PYZus{}batches} \PY{o}{=} \PY{l+m+mi}{2}
\PY{n}{source\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{l+m+mi}{32}
\PY{n}{target\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{l+m+mi}{32}
\PY{n}{learning\PYZus{}rate} \PY{o}{=} \PY{l+m+mf}{5e\PYZhy{}3}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{custom-functions-and-classes}{%
\section*{2. Custom functions and
classes}\label{custom-functions-and-classes}}

    \hypertarget{functions}{%
\subsection*{2.1 Functions}\label{functions}}

    \hypertarget{network-parameters}{%
\subsubsection*{2.1.1 Network parameters}\label{network-parameters}}

    Function that calculates the number of parameters of a network

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{description:}
\PY{l+s+sd}{    \PYZhy{} given a model, this function returns its number of parameters (weight, bias)}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{positional args:}
\PY{l+s+sd}{    \PYZhy{} model [torch.nn.Module]: instance of the network}
\PY{l+s+sd}{optional args:}
\PY{l+s+sd}{    \PYZhy{} verbose (default=False) [bool]: if True, print a report with the parameters of each layer}
\PY{l+s+sd}{    \PYZhy{} all\PYZus{}parameters (default=False) [bool]: }
\PY{l+s+sd}{        if True, return number of all parameters, if False, return only trainable parameters}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{return:}
\PY{l+s+sd}{    \PYZhy{} [int] total parameters of the network}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}\PY{p}{;}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{nparam}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{all\PYZus{}parameters}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
    \PY{k}{if}\PY{p}{(}\PY{n}{verbose}\PY{p}{)}\PY{p}{:}
        \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{n}{total} \PY{o}{=} \PY{l+m+mi}{0}
        \PY{k}{for} \PY{n}{name}\PY{p}{,} \PY{n}{param} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{named\PYZus{}parameters}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{k}{if} \PY{p}{(}\PY{n}{param}\PY{o}{.}\PY{n}{requires\PYZus{}grad}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{}print(\PYZsq{}layer \PYZsq{}, i, \PYZsq{} name: \PYZsq{}, name)}
                \PY{n}{j} \PY{o}{=} \PY{l+m+mi}{1}
                \PY{k}{for} \PY{n}{dim} \PY{o+ow}{in} \PY{n}{param}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{:}
                    \PY{n}{j} \PY{o}{=} \PY{n}{j} \PY{o}{*} \PY{n}{dim}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{layer }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{i}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{; parameters: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{j}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n}{i} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                \PY{n}{total} \PY{o}{+}\PY{o}{=} \PY{n}{j}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{total parameters = }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{total}\PY{p}{)}
        \PY{k}{return}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{if} \PY{p}{(}\PY{n}{all\PYZus{}parameters}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{numel}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{parameters}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{return} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{numel}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{parameters}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{p}\PY{o}{.}\PY{n}{requires\PYZus{}grad}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{memory-leakage-on-exception}{%
\subsubsection*{2.1.2 Memory Leakage on
Exception}\label{memory-leakage-on-exception}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{source:}
\PY{l+s+sd}{https://docs.fast.ai/troubleshoot.html\PYZsh{}memory\PYZhy{}leakage\PYZhy{}on\PYZhy{}exception}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{Decorator used to reclaim GPU RAM (check the source website)}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
'\textbackslash{}nsource:\textbackslash{}nhttps://docs.fast.ai/troubleshoot.html\#memory-leakage-on-
exception\textbackslash{}n\#-------------------\textbackslash{}nDecorator used to reclaim GPU RAM (check the
source website)\textbackslash{}n'
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} decorator from Paulo\PYZsq{}s notebook}
\PY{k}{def} \PY{n+nf}{gpu\PYZus{}mem\PYZus{}restore}\PY{p}{(}\PY{n}{func}\PY{p}{)}\PY{p}{:}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Reclaim GPU RAM if CUDA out of memory happened, or execution was interrupted}\PY{l+s+s2}{\PYZdq{}}
    \PY{n+nd}{@functools}\PY{o}{.}\PY{n}{wraps}\PY{p}{(}\PY{n}{func}\PY{p}{)}
    \PY{k}{def} \PY{n+nf}{wrapper}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}\PY{p}{:}
        \PY{k}{try}\PY{p}{:}
            \PY{k}{return} \PY{n}{func}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
        \PY{k}{except}\PY{p}{:}
            \PY{n+nb}{type}\PY{p}{,} \PY{n}{val}\PY{p}{,} \PY{n}{tb} \PY{o}{=} \PY{n}{sys}\PY{o}{.}\PY{n}{exc\PYZus{}info}\PY{p}{(}\PY{p}{)}
            \PY{n}{traceback}\PY{o}{.}\PY{n}{clear\PYZus{}frames}\PY{p}{(}\PY{n}{tb}\PY{p}{)}
            \PY{k}{raise} \PY{n+nb}{type}\PY{p}{(}\PY{n}{val}\PY{p}{)}\PY{o}{.}\PY{n}{with\PYZus{}traceback}\PY{p}{(}\PY{n}{tb}\PY{p}{)} \PY{k+kn}{from} \PY{n+nb+bp}{None}
    \PY{k}{return} \PY{n}{wrapper}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{hardware-status}{%
\subsubsection*{2.1.3 Hardware status}\label{hardware-status}}

    This function can be used with tqdm to monitor CPU \& GPU in status bar

function based on Diedre's notebook.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} \PYZsq{}\PYZsq{}\PYZsq{}}
\PY{c+c1}{\PYZsh{} function to monitor GPU usage }
\PY{c+c1}{\PYZsh{} (which should be near 100\PYZpc{} during the training loop)}
\PY{c+c1}{\PYZsh{} \PYZsq{}\PYZsq{}\PYZsq{}}
\PY{c+c1}{\PYZsh{} def gpu\PYZus{}usage():}
\PY{c+c1}{\PYZsh{}     global handle}
\PY{c+c1}{\PYZsh{}     return str(nvidia\PYZus{}smi.nvmlDeviceGetUtilizationRates(handle).gpu) + \PYZsq{}\PYZpc{}\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{hardware\PYZus{}status}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{    function that monitors CPU \PYZam{} GPU and returns a }
\PY{l+s+sd}{    dictionary with some of their status}
\PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
    \PY{n}{res} \PY{o}{=} \PY{n}{nvidia\PYZus{}smi}\PY{o}{.}\PY{n}{nvmlDeviceGetUtilizationRates}\PY{p}{(}\PY{n}{handle}\PY{p}{)}
    \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cpu}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n+nb}{str}\PY{p}{(}\PY{n}{psutil}\PY{o}{.}\PY{n}{cpu\PYZus{}percent}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mem}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n+nb}{str}\PY{p}{(}\PY{n}{psutil}\PY{o}{.}\PY{n}{virtual\PYZus{}memory}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{percent}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gpu}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n+nb}{str}\PY{p}{(}\PY{n}{res}\PY{o}{.}\PY{n}{gpu}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gpu\PYZus{}mem}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n+nb}{str}\PY{p}{(}\PY{n}{res}\PY{o}{.}\PY{n}{memory}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{function-to-load-texts}{%
\subsubsection*{2.1.4 Function to load
texts}\label{function-to-load-texts}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{function that reads .txt files and return them as a list}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{parameters:}
\PY{l+s+sd}{    path: directory where the .txt files are}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{c+c1}{\PYZsh{} function that reads .txt files and return them as a list}
\PY{k}{def} \PY{n+nf}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
    \PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{gzip}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{path}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{n}{text\PYZus{}pairs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{line}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{text\PYZus{}pairs}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{function-to-get-optimizer}{%
\subsubsection*{2.1.5 Function to get
optimizer}\label{function-to-get-optimizer}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{function that returns the optimizer associated to a string}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{parameters:}
\PY{l+s+sd}{    opt:}
\PY{l+s+sd}{    \PYZhy{} \PYZsq{}Adam\PYZsq{}: returns the Adam optimizer}
\PY{l+s+sd}{    \PYZhy{} \PYZsq{}SGD\PYZsq{}:  returns the Stochastic Gradient Descent optimizer}
\PY{l+s+sd}{    \PYZhy{} otherwise raise an error}
\PY{l+s+sd}{    lr: learning rate}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{k}{def} \PY{n+nf}{get\PYZus{}optimizer}\PY{p}{(}\PY{n}{opt}\PY{p}{,} \PY{n}{lr}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{p}{(}\PY{n}{opt} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{Adam}\PY{p}{(} \PY{p}{[}\PY{n}{p} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{model}\PY{o}{.}\PY{n}{parameters}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{p}\PY{o}{.}\PY{n}{requires\PYZus{}grad}\PY{p}{]}\PY{p}{,}
            \PY{n}{lr}\PY{o}{=}\PY{n}{lr}\PY{p}{,} \PY{n}{eps}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}08}\PY{p}{)}
    \PY{k}{elif} \PY{p}{(}\PY{n}{opt} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SGD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{SGD}\PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{parameters}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{lr}\PY{o}{=}\PY{n}{lr}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Unsupported optimizer: }\PY{l+s+si}{\PYZob{}}\PY{n}{opt}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{function-to-get-loss-function}{%
\subsubsection*{2.1.6 Function to get loss
function}\label{function-to-get-loss-function}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{function that returns the loss function associated to a string}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{parameters:}
\PY{l+s+sd}{    loss\PYZus{}func:}
\PY{l+s+sd}{    \PYZhy{} \PYZsq{}CE\PYZsq{}:   returns the Cross Entropy loss function}
\PY{l+s+sd}{    \PYZhy{} \PYZsq{}MSE\PYZsq{}:  returns the Mean Squared Error loss function}
\PY{l+s+sd}{    \PYZhy{} otherwise raise an error}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{k}{def} \PY{n+nf}{get\PYZus{}loss\PYZus{}func}\PY{p}{(}\PY{n}{loss\PYZus{}func}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{p}{(}\PY{n}{loss\PYZus{}func} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{CrossEntropyLoss}\PY{p}{(}\PY{p}{)}
    \PY{k}{elif} \PY{p}{(}\PY{n}{loss\PYZus{}func} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{MSELoss}\PY{p}{(}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unsupported loss function: }\PY{l+s+si}{\PYZob{}}\PY{n}{loss\PYZus{}func}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{function-to-get-tokenizer}{%
\subsubsection*{2.1.7 Function to get
tokenizer}\label{function-to-get-tokenizer}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{function that returns the tokenizer associated to a string}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{parameters:}
\PY{l+s+sd}{    tokenizer:}
\PY{l+s+sd}{    \PYZhy{} \PYZsq{}BERT\PYZsq{}: returns the BERT tokenizer}
\PY{l+s+sd}{    \PYZhy{} otherwise raise an error}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{k}{def} \PY{n+nf}{get\PYZus{}tokenizer}\PY{p}{(}\PY{n}{tokenizer}\PY{p}{,} \PY{n}{model\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{p}{(}\PY{n}{tokenizer} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{BertTokenizer}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bert\PYZhy{}base\PYZhy{}uncased}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{elif} \PY{p}{(}\PY{n}{tokenizer} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{T5Tokenizer}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{n}{use\PYZus{}bfloat16}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unsupported tokenizer: }\PY{l+s+si}{\PYZob{}}\PY{n}{tokenizer}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{function-to-get-model}{%
\subsubsection*{2.1.8 Function to get
model}\label{function-to-get-model}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{function that returns the the network model associated to a string}
\PY{l+s+sd}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{parameters:}
\PY{l+s+sd}{    model\PYZus{}name:}
\PY{l+s+sd}{    \PYZhy{} BERT models:}
\PY{l+s+sd}{        \PYZhy{} \PYZsq{}bert\PYZhy{}base\PYZhy{}uncased\PYZsq{} (110 M params)}
\PY{l+s+sd}{        \PYZhy{} \PYZsq{}bert\PYZhy{}large\PYZhy{}uncased\PYZsq{} (340 M params)}
\PY{l+s+sd}{    \PYZhy{} T5 models:}
\PY{l+s+sd}{        \PYZhy{} \PYZsq{}t5\PYZhy{}small\PYZsq{} (60 M params)}
\PY{l+s+sd}{        \PYZhy{} \PYZsq{}t5\PYZhy{}base\PYZsq{}  (220 M params)}
\PY{l+s+sd}{        \PYZhy{} \PYZsq{}t5\PYZhy{}large\PYZsq{} (770 M params)}
\PY{l+s+sd}{        \PYZhy{} \PYZsq{}t5\PYZhy{}3B\PYZsq{}    (2.8 B params)}
\PY{l+s+sd}{        \PYZhy{} \PYZsq{}t5\PYZhy{}11B\PYZsq{}   (11 B params)}
\PY{l+s+sd}{    \PYZhy{} otherwise raise an error}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{k}{def} \PY{n+nf}{get\PYZus{}model}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{p}{(}\PY{p}{(}\PY{n}{model\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bert\PYZhy{}base\PYZhy{}uncased}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o+ow}{or} 
        \PY{p}{(}\PY{n}{model\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bert\PYZhy{}large\PYZhy{}uncased}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{BertTokenizer}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{)}
    \PY{k}{elif} \PY{p}{(}\PY{p}{(}\PY{n}{model\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t5\PYZhy{}small}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o+ow}{or} 
            \PY{p}{(}\PY{n}{model\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t5\PYZhy{}base}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o+ow}{or}
            \PY{p}{(}\PY{n}{model\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t5\PYZhy{}large}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o+ow}{or} 
            \PY{p}{(}\PY{n}{model\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t5\PYZhy{}3B}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o+ow}{or}
            \PY{p}{(}\PY{n}{model\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t5\PYZhy{}11B}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{T5ForConditionalGeneration}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{n}{use\PYZus{}bfloat16}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unsupported model: }\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{classes}{%
\subsection*{2.2 Classes}\label{classes}}

    \hypertarget{dataset-class}{%
\subsection*{2.2.1 Dataset Class}\label{dataset-class}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} }
\PY{l+s+sd}{max\PYZus{}length is added by 5 because of the prefix: }
\PY{l+s+sd}{[\PYZdq{}translate\PYZdq{}, \PYZdq{}English\PYZdq{}, \PYZdq{}to\PYZdq{}, \PYZdq{}Portuguese\PYZdq{}, \PYZdq{}:\PYZdq{}] }
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{k}{class} \PY{n+nc}{ParaCrawlDS}\PY{p}{(}\PY{n}{Dataset}\PY{p}{)}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{text\PYZus{}pairs}\PY{p}{:} \PY{n}{List}\PY{p}{[}\PY{n}{Tuple}\PY{p}{[}\PY{n+nb}{str}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{tokenizer}\PY{p}{,}
                 \PY{n}{source\PYZus{}max\PYZus{}length}\PY{p}{:} \PY{n+nb}{int} \PY{o}{=} \PY{l+m+mi}{32}\PY{p}{,} \PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{:} \PY{n+nb}{int} \PY{o}{=} \PY{l+m+mi}{32}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer} \PY{o}{=} \PY{n}{tokenizer}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{n}{text\PYZus{}pairs}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{source\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n}{source\PYZus{}max\PYZus{}length}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n}{target\PYZus{}max\PYZus{}length}
        
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}len\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{text\PYZus{}pairs}\PY{p}{)}
    
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}getitem\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{idx}\PY{p}{)}\PY{p}{:}
        \PY{n}{source}\PY{p}{,} \PY{n}{target} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{text\PYZus{}pairs}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} encode source sequence}
        \PY{n}{source\PYZus{}encode} \PY{o}{=} \PY{n}{tokenizer}\PY{o}{.}\PY{n}{encode\PYZus{}plus}\PY{p}{(}
            \PY{n}{text}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{translate English to Portuguese: }\PY{l+s+si}{\PYZob{}}\PY{n}{source}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ \PYZlt{}/s\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{n}{max\PYZus{}length}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{source\PYZus{}max\PYZus{}length}\PY{p}{,}
            \PY{n}{pad\PYZus{}to\PYZus{}max\PYZus{}length}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
            \PY{n}{return\PYZus{}token\PYZus{}type\PYZus{}ids}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
            \PY{n}{return\PYZus{}attention\PYZus{}mask}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
            \PY{n}{return\PYZus{}tensors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{p}{)}
        \PY{c+c1}{\PYZsh{} get mask and tokens\PYZsq{} ids of encoded source sequence}
        \PY{n}{source\PYZus{}mask} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{source\PYZus{}encode}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attention\PYZus{}mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{source\PYZus{}token\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{source\PYZus{}encode}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{input\PYZus{}ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} encode target sequence}
        \PY{n}{target\PYZus{}encode} \PY{o}{=} \PY{n}{tokenizer}\PY{o}{.}\PY{n}{encode\PYZus{}plus}\PY{p}{(}
            \PY{n}{text}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{target}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ \PYZlt{}/s\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
            \PY{n}{max\PYZus{}length}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{,}
            \PY{n}{pad\PYZus{}to\PYZus{}max\PYZus{}length}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
            \PY{n}{return\PYZus{}token\PYZus{}type\PYZus{}ids}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}
            \PY{n}{return\PYZus{}attention\PYZus{}mask}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
            \PY{n}{return\PYZus{}tensors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{p}{)}
        \PY{c+c1}{\PYZsh{} get mask and tokens\PYZsq{} ids of encoded target sequence}
        \PY{n}{target\PYZus{}mask} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{target\PYZus{}encode}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attention\PYZus{}mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{target\PYZus{}token\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{target\PYZus{}encode}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{input\PYZus{}ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{k}{return} \PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{,} 
            \PY{n}{target\PYZus{}mask}\PY{p}{,} \PY{n}{source}\PY{p}{,} \PY{n}{target}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{dataset-pre-processing}{%
\section*{3. Dataset Pre-processing}\label{dataset-pre-processing}}

    \hypertarget{download-dataset}{%
\subsection*{3.1 Download dataset}\label{download-dataset}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} download dataset (1M train, 20k test)}
\PY{o}{!} wget \PYZhy{}q \PYZhy{}nc https://storage.googleapis.com/neuralresearcher\PYZus{}data/unicamp/ia376e\PYZus{}2020s1/paracrawl\PYZus{}enpt\PYZus{}train.tsv.gz
\PY{o}{!} wget \PYZhy{}q \PYZhy{}nc https://storage.googleapis.com/neuralresearcher\PYZus{}data/unicamp/ia376e\PYZus{}2020s1/paracrawl\PYZus{}enpt\PYZus{}test.tsv.gz
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{loading-the-dataset}{%
\subsection*{3.2 Loading the dataset}\label{loading-the-dataset}}

    Function to load dataset

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{n}{path}\PY{p}{)}\PY{p}{:}
    \PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{gzip}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{path}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
        \PY{n}{text\PYZus{}pairs}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{line}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{text\PYZus{}pairs}
\end{Verbatim}
\end{tcolorbox}

    Load dataset

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paracrawl\PYZus{}enpt\PYZus{}train.tsv.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paracrawl\PYZus{}enpt\PYZus{}test.tsv.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{splitting-the-dataset}{%
\subsection*{3.3 Splitting the dataset}\label{splitting-the-dataset}}

    Training/Development split

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} shuffle data before spliting}
\PY{n}{random}\PY{o}{.}\PY{n}{shuffle}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}
\PY{c+c1}{\PYZsh{} create validation set with 5k pairs}
\PY{n}{x\PYZus{}val} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{100000}\PY{p}{:}\PY{l+m+mi}{105000}\PY{p}{]}
\PY{c+c1}{\PYZsh{} truncate the first 100k pairs for training}
\PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{100000}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    Print a few pair samples

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{set\PYZus{}name}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{training}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{validation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x\PYZus{}val}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x\PYZus{}test}\PY{p}{)}\PY{p}{]}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ samples from }\PY{l+s+si}{\PYZob{}}\PY{n}{set\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ set}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{First 3 samples of }\PY{l+s+si}{\PYZob{}}\PY{n}{set\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{p}{(}\PY{n}{source}\PY{p}{,} \PY{n}{target}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{i}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{: source: }\PY{l+s+si}{\PYZob{}}\PY{n}{source}\PY{l+s+si}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{   target: }\PY{l+s+si}{\PYZob{}}\PY{n}{target}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]

100000 samples from training set
First 3 samples of training set:
0: source: The French General THIBAULT was killed, and BRENNIER, who had a
command in the affair of the 17th, taken prisoner.
   target: O General francs THIBAULT foi morto, e BRENNIER, que fora um dos
comandantes no combate do dia 17, foi feito prisioneiro.
1: source: Before KBDSW09.DLL scanning, make sure your PC no virus and trojan.
We recommend HitMalware.
   target: Antes de KBDSW09.DLL digitalizao, verifique se o seu PC no e vrus
Trojan. Recomendamos HitMalware.
2: source: There are several means of transport through which you can explore
the different parts of this country. One can use buses, taxis or car rentals,
which is the best and most convenient means of transport.
   target: Existem vrios meios de transporte, atravs da qual pode explorar as
diferentes partes do pas. Pode-se usar nibus, txis ou carro de aluguel, que 
os melhores e mais convenientes de meios de transporte.

5000 samples from validation set
First 3 samples of validation set:
0: source: The volume for the activated audio/video source will then be switched
off.
   target: A fonte udio/vdeo  colocada em Mute.
1: source: Well tested and high quality yellow laser pointer
   target: Bem testado e de alta qualidade laser pointer amarelo
2: source: It supports recovery of photos from external hard drive brands such
as LaCie, Western Digital, Seagate, Toshiba, Iomega, etc on Mac OS X machine. It
is possible to get back media files from various types of flash memory cards
such as xD card, SD card, SDHC card, SDXC card, CF card, MMC and Memory Stick
that are used in modern DSLR cameras and Smart phones on Mac computer by using
Yodot Mac photo recovery software.
   target: Ele suporta a recuperao de fotos de marcas de discos rgidos
externos, como LaCie, Western Digital, Seagate, Toshiba, Iomega, etc na mquina
Mac OS X.  possvel voltar arquivos de mdia a partir de vrios tipos de
cartes de memria flash, como carto de xD, carto SD, SDHC, SDXC, carto CF,
MMC e Memory Stick que so usados em cmeras DSLR modernas e telefones
inteligentes no computador Mac por usando o software de recuperao de
fotografia Yodot Mac.

20000 samples from test set
First 3 samples of test set:
0: source: In this way, the civil life of a nation matures, making it possible
for all citizens to enjoy the fruits of genuine tolerance and mutual respect.
   target: Deste modo, a vida civil de uma nao amadurece, fazendo com que
todos os cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.
1: source: 1999 XIII. Winnipeg, Canada July 23 to August 8
   target: 1999 XIII. Winnipeg, Canad 23 de julho a 8 de agosto
2: source: In the mystery of Christmas, Christ's light shines on the earth,
spreading, as it were, in concentric circles.
   target: No mistrio do Natal, a luz de Cristo irradia-se sobre a terra,
difundindo-se como crculos concntricos.
    \end{Verbatim}

    \hypertarget{testing-the-dataloader}{%
\subsection*{3.4 Testing the Dataloader}\label{testing-the-dataloader}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{tokenizer} \PY{o}{=} \PY{n}{T5Tokenizer}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{I like pizza}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{eu gosto de pizza}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}
\PY{n}{dataset\PYZus{}debug} \PY{o}{=} \PY{n}{ParaCrawlDS}\PY{p}{(}
    \PY{n}{text\PYZus{}pairs}\PY{o}{=}\PY{n}{text\PYZus{}pairs}\PY{p}{,}
    \PY{n}{tokenizer}\PY{o}{=}\PY{n}{tokenizer}\PY{p}{,}
    \PY{n}{source\PYZus{}max\PYZus{}length}\PY{o}{=}\PY{n}{source\PYZus{}max\PYZus{}length}\PY{p}{,}
    \PY{n}{target\PYZus{}max\PYZus{}length}\PY{o}{=}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{)}

\PY{n}{dataloader\PYZus{}debug} \PY{o}{=} \PY{n}{DataLoader}\PY{p}{(}\PY{n}{dataset\PYZus{}debug}\PY{p}{,} \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} 
                              \PY{n}{num\PYZus{}workers}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{target\PYZus{}mask}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n+nb}{next}\PY{p}{(}\PY{n+nb}{iter}\PY{p}{(}\PY{n}{dataloader\PYZus{}debug}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{source\PYZus{}token\PYZus{}ids:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{source\PYZus{}mask:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target\PYZus{}token\PYZus{}ids:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target\PYZus{}mask:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{target\PYZus{}mask}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{source\PYZus{}token\PYZus{}ids.shape:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{source\PYZus{}mask.shape:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target\PYZus{}token\PYZus{}ids.shape:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target\PYZus{}mask.shape:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{target\PYZus{}mask}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
source\_token\_ids:
 tensor([[13959,  1566,    12, 21076,    10,    27,   114,  6871,     1,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
             0,     0]])
source\_mask:
 tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0,
         0, 0, 0, 0, 0, 0, 0, 0]])
target\_token\_ids:
 tensor([[   3,   15,   76,  281,    7,  235,   20, 6871,    1,    0,    0,
0,
            0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
            0,    0,    0,    0,    0,    0,    0,    0]])
target\_mask:
 tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0,
         0, 0, 0, 0, 0, 0, 0, 0]])
\#-------------------
source\_token\_ids.shape: torch.Size([1, 32])
source\_mask.shape: torch.Size([1, 32])
target\_token\_ids.shape: torch.Size([1, 32])
target\_mask.shape: torch.Size([1, 32])
    \end{Verbatim}

    \hypertarget{network-model}{%
\section*{4. Network Model}\label{network-model}}

    \hypertarget{hiperparameters}{%
\subsection*{4.1 Hiperparameters}\label{hiperparameters}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{hyperparameters} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{c+c1}{\PYZsh{} description}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{experiment\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T5\PYZus{}v1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
    \PY{c+c1}{\PYZsh{} training / early stopping}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max\PYZus{}epochs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{patience}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
    \PY{c+c1}{\PYZsh{} dataset}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset\PYZus{}class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{ParaCrawlDS}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{training\PYZus{}size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{100\PYZus{}000}\PY{p}{,}
    \PY{c+c1}{\PYZsh{}\PYZsq{}training\PYZus{}size\PYZsq{}: 1\PYZus{}000,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split\PYZus{}train\PYZus{}val}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.98}\PY{p}{,}
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
    \PY{c+c1}{\PYZsh{} dataloader}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{batch\PYZus{}size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{64}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accumulate\PYZus{}grad\PYZus{}batches}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nworkers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
    \PY{c+c1}{\PYZsh{} network architecture}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tokenizer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{t5\PYZhy{}small}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{source\PYZus{}max\PYZus{}length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{105}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target\PYZus{}max\PYZus{}length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{100}\PY{p}{,}
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
    \PY{c+c1}{\PYZsh{} optimizer}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss\PYZus{}func}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{opt\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Adam}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{5e\PYZhy{}3}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scheduling\PYZus{}factor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.95}\PY{p}{,}
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
    \PY{c+c1}{\PYZsh{} others}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{manual\PYZus{}seed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{42}\PY{p}{,}  \PY{c+c1}{\PYZsh{} RNG seed}
\PY{p}{\PYZcb{}}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{network-model-definition}{%
\subsection*{4.2 Network model
definition}\label{network-model-definition}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{LightnigModule based on the reference notebook from Diedre.}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{k}{class} \PY{n+nc}{T5EnPtTranslator}\PY{p}{(}\PY{n}{pl}\PY{o}{.}\PY{n}{LightningModule}\PY{p}{)}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{hparams}\PY{p}{,} \PY{n}{dl\PYZus{}shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{decoder}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{greedy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{k}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{p}\PY{o}{=}\PY{l+m+mf}{0.95}\PY{p}{,} \PY{n}{num\PYZus{}beams}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{hugging\PYZus{}face}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
        \PY{n+nb}{super}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams} \PY{o}{=} \PY{n}{hparams}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dl\PYZus{}shuffle} \PY{o}{=} \PY{n}{dl\PYZus{}shuffle}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{DatasetClass} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{dataset\PYZus{}class}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model} \PY{o}{=} \PY{n}{get\PYZus{}model}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{model\PYZus{}name}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer} \PY{o}{=} \PY{n}{get\PYZus{}tokenizer}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{tokenizer}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{model\PYZus{}name}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{loss\PYZus{}func} \PY{o}{=} \PY{n}{get\PYZus{}loss\PYZus{}func}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{loss\PYZus{}func}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{n}{decoder}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{k} \PY{o}{=} \PY{n}{k}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p} \PY{o}{=} \PY{n}{p}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{num\PYZus{}beams} \PY{o}{=} \PY{n}{num\PYZus{}beams}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{n}{hugging\PYZus{}face}

    \PY{k}{def} \PY{n+nf}{forward}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{training}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} All labels set to \PYZhy{}100 are ignored (masked), the loss is only computed for labels in [0, ..., config.vocab\PYZus{}size]}
            \PY{c+c1}{\PYZsh{} https://huggingface.co/transformers/model\PYZus{}doc/t5.html\PYZsh{}t5forconditionalgeneration}
            \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{[}\PY{n}{target\PYZus{}token\PYZus{}ids} \PY{o}{==} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer}\PY{o}{.}\PY{n}{pad\PYZus{}token\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{100}
            \PY{n}{outputs} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{p}{(}
                \PY{n}{input\PYZus{}ids} \PY{o}{=} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,}
                \PY{n}{attention\PYZus{}mask} \PY{o}{=} \PY{n}{source\PYZus{}mask}\PY{p}{,} 
                \PY{n}{lm\PYZus{}labels} \PY{o}{=} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{)}
            \PY{n}{loss} \PY{o}{=} \PY{n}{outputs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
            \PY{k}{return} \PY{n}{loss}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} use hugging face decoding}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}    }
        \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hugging\PYZus{}face}\PY{p}{:}
            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{decoder} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{predicted\PYZus{}token\PYZus{}ids} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{generate}\PY{p}{(}
                    \PY{n}{input\PYZus{}ids} \PY{o}{=} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,}
                    \PY{n}{max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{,}
                    \PY{n}{do\PYZus{}sample} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,}
                    \PY{n}{top\PYZus{}k} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{k}\PY{p}{,}
                \PY{p}{)}
            \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{decoder} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{predicted\PYZus{}token\PYZus{}ids} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{generate}\PY{p}{(}
                    \PY{n}{input\PYZus{}ids} \PY{o}{=} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,}
                    \PY{n}{max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{,}
                    \PY{n}{do\PYZus{}sample} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,}
                    \PY{n}{top\PYZus{}p} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{,}
                \PY{p}{)}
            \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{decoder} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beam\PYZhy{}search}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{predicted\PYZus{}token\PYZus{}ids} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{generate}\PY{p}{(}
                    \PY{n}{input\PYZus{}ids} \PY{o}{=} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,}
                    \PY{n}{max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{,}
                    \PY{n}{do\PYZus{}sample} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,}
                    \PY{n}{num\PYZus{}beams} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{num\PYZus{}beams}\PY{p}{,}
                \PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} greedy \PYZsq{}\PYZsq{}\PYZsq{}}
                \PY{n}{predicted\PYZus{}token\PYZus{}ids} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{generate}\PY{p}{(}
                    \PY{n}{input\PYZus{}ids} \PY{o}{=} \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,}
                    \PY{n}{max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{,}
                    \PY{n}{do\PYZus{}sample} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,}
                \PY{p}{)}
            \PY{k}{return} \PY{n}{predicted\PYZus{}token\PYZus{}ids}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} use my decoding implementations}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{decoder} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} fill tensor with start token ID}
                \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{full}\PY{p}{(}
                    \PY{n}{size} \PY{o}{=} \PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                    \PY{n}{fill\PYZus{}value} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{config}\PY{o}{.}\PY{n}{decoder\PYZus{}start\PYZus{}token\PYZus{}id}\PY{p}{,}
                    \PY{n}{dtype} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{long}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} send tensor to device}
                \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{decoded\PYZus{}ids}\PY{o}{.}\PY{n}{to}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{device}\PY{p}{)}
                \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
                \PY{n}{encoder\PYZus{}hidden\PYZus{}states} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{get\PYZus{}encoder}\PY{p}{(}\PY{p}{)}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{attention\PYZus{}mask}\PY{o}{=}\PY{n}{source\PYZus{}mask}\PY{p}{)}
                \PY{k}{for} \PY{n}{step} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{)}\PY{p}{:}
                    \PY{n}{logits}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{p}{(}
                        \PY{n}{decoder\PYZus{}input\PYZus{}ids} \PY{o}{=} \PY{n}{decoded\PYZus{}ids}\PY{p}{,}
                        \PY{n}{encoder\PYZus{}outputs} \PY{o}{=} \PY{n}{encoder\PYZus{}hidden\PYZus{}states}\PY{p}{,}
                        \PY{n}{attention\PYZus{}mask} \PY{o}{=} \PY{n}{source\PYZus{}mask}\PY{p}{)}
                    \PY{n}{next\PYZus{}token\PYZus{}logits} \PY{o}{=} \PY{n}{logits}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{p}{:}\PY{p}{]}
\PY{c+c1}{\PYZsh{}                    pdb.set\PYZus{}trace()}
                    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
                    \PY{c+c1}{\PYZsh{}roulette = torch.topk(next\PYZus{}token\PYZus{}logits, k=self.k, sorted=False)[1]}
                    \PY{c+c1}{\PYZsh{}chosen = torch.randint(self.k, (1,1)).item()}
                    \PY{c+c1}{\PYZsh{}next\PYZus{}token\PYZus{}id = roulette[:,chosen].unsqueeze(\PYZhy{}1)}
                    \PY{n}{roulette} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{topk}\PY{p}{(}\PY{n}{next\PYZus{}token\PYZus{}logits}\PY{p}{,} \PY{n}{k}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{k}\PY{p}{,} \PY{n+nb}{sorted}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                    \PY{n}{next\PYZus{}token\PYZus{}id} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{roulette}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n}{roulette}\PY{o}{.}\PY{n}{dtype}\PY{p}{,} \PY{n}{device}\PY{o}{=}\PY{n}{roulette}\PY{o}{.}\PY{n}{device}\PY{p}{)}
                    \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{topk} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{roulette}\PY{p}{)}\PY{p}{:}
                        \PY{n}{next\PYZus{}token\PYZus{}id}\PY{p}{[}\PY{n}{idx}\PY{p}{]} \PY{o}{=} \PY{n}{roulette}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{[}\PY{n}{torch}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{k}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{item}\PY{p}{(}\PY{p}{)}\PY{p}{]}
                    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
                    \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cat}\PY{p}{(}\PY{p}{[}\PY{n}{decoded\PYZus{}ids}\PY{p}{,} \PY{n}{next\PYZus{}token\PYZus{}id}\PY{p}{]}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{k}{return} \PY{n}{decoded\PYZus{}ids}                
            \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
            \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{decoder} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}p}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{full}\PY{p}{(}
                    \PY{n}{size} \PY{o}{=} \PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                    \PY{n}{fill\PYZus{}value} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{config}\PY{o}{.}\PY{n}{decoder\PYZus{}start\PYZus{}token\PYZus{}id}\PY{p}{,}
                    \PY{n}{dtype} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{long}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} send tensor to device}
                \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{decoded\PYZus{}ids}\PY{o}{.}\PY{n}{to}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{device}\PY{p}{)}
                \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
                \PY{n}{encoder\PYZus{}hidden\PYZus{}states} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{get\PYZus{}encoder}\PY{p}{(}\PY{p}{)}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{attention\PYZus{}mask}\PY{o}{=}\PY{n}{source\PYZus{}mask}\PY{p}{)}
                \PY{k}{for} \PY{n}{step} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{)}\PY{p}{:}
                    \PY{n}{logits}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{p}{(}
                        \PY{n}{decoder\PYZus{}input\PYZus{}ids} \PY{o}{=} \PY{n}{decoded\PYZus{}ids}\PY{p}{,}
                        \PY{n}{encoder\PYZus{}outputs} \PY{o}{=} \PY{n}{encoder\PYZus{}hidden\PYZus{}states}\PY{p}{,}
                        \PY{n}{attention\PYZus{}mask} \PY{o}{=} \PY{n}{source\PYZus{}mask}\PY{p}{)}
                    \PY{n}{next\PYZus{}token\PYZus{}logits} \PY{o}{=} \PY{n}{logits}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{p}{:}\PY{p}{]}
                    \PY{c+c1}{\PYZsh{}pdb.set\PYZus{}trace()}
                    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
                    \PY{c+c1}{\PYZsh{} softmax to calculate probs from logits}
                    \PY{n}{probs} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{softmax}\PY{p}{(}\PY{n}{next\PYZus{}token\PYZus{}logits}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}         \PY{c+c1}{\PYZsh{} (B x V)}
                    \PY{c+c1}{\PYZsh{} sort probs}
                    \PY{n}{probs\PYZus{}sorted}\PY{p}{,} \PY{n}{indices} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{probs}\PY{p}{,} \PY{n}{descending}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}    \PY{c+c1}{\PYZsh{} (B x V)}
                    \PY{c+c1}{\PYZsh{} cumulative sum of sorted probs}
                    \PY{n}{cumulative} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{n}{probs\PYZus{}sorted}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}                \PY{c+c1}{\PYZsh{} (B x V)}
                    \PY{c+c1}{\PYZsh{} get number of p tokens}
                    \PY{n}{top\PYZus{}p} \PY{o}{=} \PY{p}{(}\PY{n}{cumulative} \PY{o}{\PYZlt{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{dim}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}            \PY{c+c1}{\PYZsh{} (B)}
                    \PY{c+c1}{\PYZsh{} set prob=0 for tokens out of p}
                    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{p} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{top\PYZus{}p}\PY{p}{)}\PY{p}{:}
                        \PY{n}{probs\PYZus{}sorted}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{p}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                    \PY{c+c1}{\PYZsh{} sample from probs of p tokens that left}
                    \PY{n}{indices\PYZus{}sampled} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{multinomial}\PY{p}{(}\PY{n}{probs\PYZus{}sorted}\PY{p}{,} \PY{n}{num\PYZus{}samples}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                    \PY{c+c1}{\PYZsh{} restore original index from indices (returned from torch.sort)}
                    \PY{n}{next\PYZus{}token\PYZus{}id} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{clone}\PY{p}{(}\PY{n}{top\PYZus{}p}\PY{p}{)}\PY{o}{.}\PY{n}{unsqueeze}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}        \PY{c+c1}{\PYZsh{} (B x 1)}
                    \PY{k}{for} \PY{n}{batch}\PY{p}{,} \PY{n}{idx} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{indices\PYZus{}sampled}\PY{p}{)}\PY{p}{:}
                        \PY{n}{next\PYZus{}token\PYZus{}id}\PY{p}{[}\PY{n}{batch}\PY{p}{]} \PY{o}{=} \PY{n}{indices}\PY{p}{[}\PY{n}{batch}\PY{p}{]}\PY{p}{[}\PY{n}{idx}\PY{p}{]}
                    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
                    \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cat}\PY{p}{(}\PY{p}{[}\PY{n}{decoded\PYZus{}ids}\PY{p}{,} \PY{n}{next\PYZus{}token\PYZus{}id}\PY{p}{]}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{k}{return} \PY{n}{decoded\PYZus{}ids}                
            \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
            \PY{k}{elif} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{decoder} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beam\PYZhy{}search}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{beam\PYZhy{}search}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
            \PY{k}{else}\PY{p}{:}
                \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{} greedy decoding \PYZsq{}\PYZsq{}\PYZsq{}}
                \PY{c+c1}{\PYZsh{} fill tensor with start token ID}
                \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{full}\PY{p}{(}
                    \PY{n}{size} \PY{o}{=} \PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                    \PY{n}{fill\PYZus{}value} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{config}\PY{o}{.}\PY{n}{decoder\PYZus{}start\PYZus{}token\PYZus{}id}\PY{p}{,}
                    \PY{n}{dtype} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{long}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} send tensor to device}
                \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{decoded\PYZus{}ids}\PY{o}{.}\PY{n}{to}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{o}{.}\PY{n}{device}\PY{p}{)}
                \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
                \PY{n}{encoder\PYZus{}hidden\PYZus{}states} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{o}{.}\PY{n}{get\PYZus{}encoder}\PY{p}{(}\PY{p}{)}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{attention\PYZus{}mask}\PY{o}{=}\PY{n}{source\PYZus{}mask}\PY{p}{)}
                \PY{k}{for} \PY{n}{step} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{)}\PY{p}{:}
                    \PY{n}{logits}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{p}{(}
                        \PY{n}{decoder\PYZus{}input\PYZus{}ids} \PY{o}{=} \PY{n}{decoded\PYZus{}ids}\PY{p}{,}
                        \PY{n}{encoder\PYZus{}outputs} \PY{o}{=} \PY{n}{encoder\PYZus{}hidden\PYZus{}states}\PY{p}{,}
                        \PY{n}{attention\PYZus{}mask} \PY{o}{=} \PY{n}{source\PYZus{}mask}\PY{p}{)}
                    \PY{n}{next\PYZus{}token\PYZus{}logits} \PY{o}{=} \PY{n}{logits}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{p}{:}\PY{p}{]}
                    \PY{n}{next\PYZus{}token\PYZus{}id} \PY{o}{=} \PY{n}{next\PYZus{}token\PYZus{}logits}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{unsqueeze}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
                    \PY{n}{decoded\PYZus{}ids} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{cat}\PY{p}{(}\PY{p}{[}\PY{n}{decoded\PYZus{}ids}\PY{p}{,} \PY{n}{next\PYZus{}token\PYZus{}id}\PY{p}{]}\PY{p}{,} \PY{n}{dim}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
                \PY{k}{return} \PY{n}{decoded\PYZus{}ids}

    \PY{k}{def} \PY{n+nf}{training\PYZus{}step}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{batch}\PY{p}{,} \PY{n}{batch\PYZus{}nb}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} calculate loss}
        \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{target\PYZus{}mask}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o}{=} \PY{n}{batch}
        \PY{n}{loss} \PY{o}{=} \PY{n+nb+bp}{self}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{)}
        \PY{n}{tensorboard\PYZus{}logs} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{batch\PYZus{}train\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{loss}\PY{p}{\PYZcb{}} \PY{c+c1}{\PYZsh{} log batch training loss in TensorBoard}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{loss}\PY{p}{,} 
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{tensorboard\PYZus{}logs}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{progress\PYZus{}bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{hardware\PYZus{}status}\PY{p}{(}\PY{p}{)}\PY{p}{\PYZcb{}}

    \PY{k}{def} \PY{n+nf}{training\PYZus{}epoch\PYZus{}end}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{outputs}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} calculate epoch loss based on mini\PYZhy{}batch average loss}
        \PY{n}{avg\PYZus{}loss} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{stack}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{outputs}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} log training epoch loss in TensorBoard}
        \PY{n}{tensorboard\PYZus{}logs} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{epoch\PYZus{}train\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}loss}\PY{p}{\PYZcb{}}
        \PY{c+c1}{\PYZsh{} send \PYZsq{}log\PYZsq{} key to the logger (TensorBoard)}
        \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{tensorboard\PYZus{}logs}\PY{p}{\PYZcb{}}

    \PY{k}{def} \PY{n+nf}{validation\PYZus{}step}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{batch}\PY{p}{,} \PY{n}{batch\PYZus{}nb}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} calculate BLEU}
        \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{target\PYZus{}mask}\PY{p}{,} \PY{n}{source\PYZus{}original}\PY{p}{,} \PY{n}{target\PYZus{}original} \PY{o}{=} \PY{n}{batch}
        \PY{n}{predicted} \PY{o}{=} \PY{n+nb+bp}{self}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{)}
        \PY{n}{translated} \PY{o}{=} \PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer}\PY{o}{.}\PY{n}{decode}\PY{p}{(}\PY{n}{token}\PY{p}{)} \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{predicted}\PY{p}{]}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{n}{bleu} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{tensor}\PY{p}{(}\PY{n}{sacrebleu}\PY{o}{.}\PY{n}{corpus\PYZus{}bleu}\PY{p}{(}\PY{n}{translated}\PY{p}{,} \PY{p}{[}\PY{n}{target\PYZus{}original}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{score}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print(source\PYZus{}original, target\PYZus{}original, translated, bleu, sep=\PYZsq{}\PYZbs{}n\PYZsq{})}
        \PY{n}{tensorboard\PYZus{}logs} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{batch\PYZus{}valid\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{bleu}\PY{p}{\PYZcb{}} \PY{c+c1}{\PYZsh{} log batch validation loss in TensorBoard}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{step\PYZus{}val\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{bleu}\PY{p}{,} 
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{tensorboard\PYZus{}logs}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{progress\PYZus{}bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{hardware\PYZus{}status}\PY{p}{(}\PY{p}{)}\PY{p}{\PYZcb{}}

    \PY{k}{def} \PY{n+nf}{validation\PYZus{}epoch\PYZus{}end}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{outputs}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} calculate validation epoch loss and accuracy}
        \PY{n}{avg\PYZus{}bleu} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{stack}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{step\PYZus{}val\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{outputs}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{n}{tensorboard\PYZus{}logs} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{epoch\PYZus{}val\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}bleu}\PY{p}{\PYZcb{}}
        \PY{n}{tqdm\PYZus{}dict} \PY{o}{=} \PY{n}{tensorboard\PYZus{}logs}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}val\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}bleu}\PY{p}{,} 
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{tensorboard\PYZus{}logs}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{progress\PYZus{}bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{tqdm\PYZus{}dict}\PY{p}{\PYZcb{}}

    \PY{k}{def} \PY{n+nf}{test\PYZus{}step}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{batch}\PY{p}{,} \PY{n}{batch\PYZus{}nb}\PY{p}{)}\PY{p}{:}
        \PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{target\PYZus{}mask}\PY{p}{,} \PY{n}{source\PYZus{}original}\PY{p}{,} \PY{n}{target\PYZus{}original} \PY{o}{=} \PY{n}{batch}
        \PY{n}{predicted} \PY{o}{=} \PY{n+nb+bp}{self}\PY{p}{(}\PY{n}{source\PYZus{}token\PYZus{}ids}\PY{p}{,} \PY{n}{source\PYZus{}mask}\PY{p}{,} \PY{n}{target\PYZus{}token\PYZus{}ids}\PY{p}{)}
        \PY{n}{translated} \PY{o}{=} \PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer}\PY{o}{.}\PY{n}{decode}\PY{p}{(}\PY{n}{token}\PY{p}{)} \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{predicted}\PY{p}{]}
        \PY{n}{bleu} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{tensor}\PY{p}{(}\PY{n}{sacrebleu}\PY{o}{.}\PY{n}{corpus\PYZus{}bleu}\PY{p}{(}\PY{n}{translated}\PY{p}{,} \PY{p}{[}\PY{n}{target\PYZus{}original}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{score}\PY{p}{)}
        \PY{k}{if} \PY{p}{(}\PY{n}{batch\PYZus{}nb} \PY{o}{\PYZpc{}} \PY{l+m+mi}{100} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{n}{source\PYZus{}original}\PY{p}{,} \PY{n}{target\PYZus{}original}\PY{p}{,} \PY{n}{translated}\PY{p}{,} \PY{n}{bleu}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{bleu}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{progress\PYZus{}bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{hardware\PYZus{}status}\PY{p}{(}\PY{p}{)}\PY{p}{\PYZcb{}}

    \PY{k}{def} \PY{n+nf}{test\PYZus{}epoch\PYZus{}end}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{outputs}\PY{p}{)}\PY{p}{:}
        \PY{n}{avg\PYZus{}test\PYZus{}bleu} \PY{o}{=} \PY{n}{torch}\PY{o}{.}\PY{n}{stack}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{outputs}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{n}{tensorboard\PYZus{}logs} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}test\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}test\PYZus{}bleu}\PY{p}{\PYZcb{}}
        \PY{n}{tqdm\PYZus{}dict} \PY{o}{=} \PY{n}{tensorboard\PYZus{}logs}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg\PYZus{}test\PYZus{}bleu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{avg\PYZus{}test\PYZus{}bleu}\PY{p}{,} 
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{tensorboard\PYZus{}logs}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{progress\PYZus{}bar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{tqdm\PYZus{}dict}\PY{p}{\PYZcb{}}

    \PY{k}{def} \PY{n+nf}{prepare\PYZus{}data}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} load training/test sets}
        \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paracrawl\PYZus{}enpt\PYZus{}train.tsv.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paracrawl\PYZus{}enpt\PYZus{}test.tsv.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} shuffle data before spliting}
        \PY{n}{random}\PY{o}{.}\PY{n}{shuffle}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} split}
        \PY{n}{split} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{split\PYZus{}train\PYZus{}val} \PY{o}{*} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{training\PYZus{}size}\PY{p}{)}
        \PY{n}{x\PYZus{}valid} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{n}{split}\PY{p}{:}\PY{p}{]}     \PY{c+c1}{\PYZsh{} create validation set}
        \PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{n}{split}\PY{p}{]}   \PY{c+c1}{\PYZsh{} truncate training set}
        \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{c+c1}{\PYZsh{} create training set}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ds\PYZus{}train} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{DatasetClass}\PY{p}{(}
            \PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{,} 
            \PY{n}{tokenizer} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer}\PY{p}{,} 
            \PY{n}{source\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{source\PYZus{}max\PYZus{}length}\PY{p}{,}
            \PY{n}{target\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} create development set}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ds\PYZus{}valid} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{DatasetClass}\PY{p}{(}
            \PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{n}{x\PYZus{}valid}\PY{p}{,} 
            \PY{n}{tokenizer} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer}\PY{p}{,} 
            \PY{n}{source\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{source\PYZus{}max\PYZus{}length}\PY{p}{,}
            \PY{n}{target\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} create test set}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ds\PYZus{}test} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{DatasetClass}\PY{p}{(}
            \PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{n}{x\PYZus{}test}\PY{p}{,} 
            \PY{n}{tokenizer} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{tokenizer}\PY{p}{,} 
            \PY{n}{source\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{source\PYZus{}max\PYZus{}length}\PY{p}{,}
            \PY{n}{target\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{target\PYZus{}max\PYZus{}length}\PY{p}{)}

    \PY{n+nd}{@gpu\PYZus{}mem\PYZus{}restore}
    \PY{k}{def} \PY{n+nf}{train\PYZus{}dataloader}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{DataLoader}\PY{p}{(}
            \PY{n}{dataset} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ds\PYZus{}train}\PY{p}{,} 
            \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{batch\PYZus{}size}\PY{p}{,}
            \PY{n}{drop\PYZus{}last} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
            \PY{n}{shuffle} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dl\PYZus{}shuffle}\PY{p}{,}
            \PY{n}{num\PYZus{}workers}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{nworkers}\PY{p}{)}

    \PY{n+nd}{@gpu\PYZus{}mem\PYZus{}restore}
    \PY{k}{def} \PY{n+nf}{val\PYZus{}dataloader}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}                
        \PY{k}{return} \PY{n}{DataLoader}\PY{p}{(}
            \PY{n}{dataset} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ds\PYZus{}valid}\PY{p}{,}
            \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{batch\PYZus{}size}\PY{p}{,}
            \PY{n}{drop\PYZus{}last} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
            \PY{n}{shuffle} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
            \PY{n}{num\PYZus{}workers}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{nworkers}\PY{p}{)}
        
    \PY{n+nd}{@gpu\PYZus{}mem\PYZus{}restore}
    \PY{k}{def} \PY{n+nf}{test\PYZus{}dataloader}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{DataLoader}\PY{p}{(}
            \PY{n}{dataset} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{ds\PYZus{}test}\PY{p}{,}
            \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{batch\PYZus{}size}\PY{p}{,}
            \PY{n}{drop\PYZus{}last} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
            \PY{n}{shuffle} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
            \PY{n}{num\PYZus{}workers}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{nworkers}\PY{p}{)}

    \PY{k}{def} \PY{n+nf}{configure\PYZus{}optimizers}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{n}{optimizer} \PY{o}{=} \PY{n}{get\PYZus{}optimizer}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{opt\PYZus{}name}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{lr}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{model}\PY{p}{)}
        \PY{n}{scheduler} \PY{o}{=} \PY{n}{StepLR}\PY{p}{(}\PY{n}{optimizer}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{hparams}\PY{o}{.}\PY{n}{scheduling\PYZus{}factor}\PY{p}{)}
        \PY{k}{return} \PY{p}{[}\PY{n}{optimizer}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{scheduler}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{test-dataset}{%
\subsubsection*{Test dataset}\label{test-dataset}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paracrawl\PYZus{}enpt\PYZus{}train.tsv.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{x\PYZus{}test} \PY{o}{=} \PY{n}{load\PYZus{}text\PYZus{}pairs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paracrawl\PYZus{}enpt\PYZus{}test.tsv.gz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} shuffle data before spliting}
\PY{n}{random}\PY{o}{.}\PY{n}{shuffle}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{)}
\PY{c+c1}{\PYZsh{} split}
\PY{n}{split} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{hyperparameters}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split\PYZus{}train\PYZus{}val}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{*} \PY{n}{hyperparameters}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{training\PYZus{}size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{x\PYZus{}valid} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{n}{split}\PY{p}{:}\PY{p}{]}     \PY{c+c1}{\PYZsh{} create validation set}
\PY{n}{x\PYZus{}train} \PY{o}{=} \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{n}{split}\PY{p}{]}   \PY{c+c1}{\PYZsh{} truncate training set}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} create test set}
\PY{n}{ds\PYZus{}test} \PY{o}{=} \PY{n}{ParaCrawlDS}\PY{p}{(}
    \PY{n}{text\PYZus{}pairs} \PY{o}{=} \PY{n}{x\PYZus{}test}\PY{p}{,} 
    \PY{n}{tokenizer} \PY{o}{=} \PY{n}{tokenizer}\PY{p}{,} 
    \PY{n}{source\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n}{hyperparameters}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{source\PYZus{}max\PYZus{}length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
    \PY{n}{target\PYZus{}max\PYZus{}length} \PY{o}{=} \PY{n}{hyperparameters}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{target\PYZus{}max\PYZus{}length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{trainer}{%
\subsubsection*{Trainer}\label{trainer}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison} \PY{o}{=} \PY{n}{pl}\PY{o}{.}\PY{n}{Trainer}\PY{p}{(}
    \PY{n}{profiler} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}              \PY{c+c1}{\PYZsh{} do not run profiler}
    \PY{n}{gpus} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}                     \PY{c+c1}{\PYZsh{} GPUs}
    \PY{n}{precision} \PY{o}{=} \PY{l+m+mi}{32}\PY{p}{,}               \PY{c+c1}{\PYZsh{} choose precision (32/16 bits)}
    \PY{n}{logger} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}               \PY{c+c1}{\PYZsh{} do not use logging (TensorBoard)}
    \PY{n}{early\PYZus{}stop\PYZus{}callback} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}  \PY{c+c1}{\PYZsh{} do not stop early}
    \PY{n}{checkpoint\PYZus{}callback} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}  \PY{c+c1}{\PYZsh{} do not save checkpoint}
    \PY{n}{overfit\PYZus{}pct} \PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{,}           \PY{c+c1}{\PYZsh{} ratio of data to overfit}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
No environment variable for node rank defined. Set as 0.
    \end{Verbatim}

    \hypertarget{model}{%
\subsubsection*{Model}\label{model}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model} \PY{o}{=} \PY{n}{T5EnPtTranslator}\PY{p}{(}\PY{n}{hparams}\PY{o}{=}\PY{n}{Namespace}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n}{hyperparameters}\PY{p}{)}\PY{p}{,} \PY{n}{dl\PYZus{}shuffle}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n}{model}\PY{o}{.}\PY{n}{load\PYZus{}state\PYZus{}dict}\PY{p}{(}\PY{n}{torch}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/content/drive/My Drive/parameters}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<All keys matched successfully>
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{unit-test}{%
\section*{Unit test}\label{unit-test}}

    \hypertarget{greedy}{%
\subsubsection*{Greedy}\label{greedy}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{greedy}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{False}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['Desta forma, a vida civil de uma na  o se avana, tornando-o poss  vel para
todos os cidad  os desfrutar dos frutos de tolerncia verdadeira e respeito
mutual.', '1999 XIII. Winnipeg, Canad 23 a 8 de agosto', 'No mistrio do Natal,
a luz de Cristo brilha na terra, esporrendo-se, como era, em c  rculos
concncios.', 'fazendo vivel fazer o ocidental dois novos fechados no ocidente
daquela pen  nsula. ocidental. ocidental. ocidentalmente ocidental.', 'Os seus
olhos estavam brilhantes e a sua voz foi linda.', 'Inferi  es, acidentes,
abuso, abuso, separa  o, choque, rapaamento, abuso, abuso, abuso, abuso,
abuso, abuso, apress  o, apress  o, a ansiedade, abuso, alimenta  o.', 'A
branque HP Maxx  um gel de clareamento de hidrognio de 35\% para o clareamento
de dentes vitales e n  o-vitais. como o l  gel de enxernamento de hidro  dio
de 35\% ao', 'Linhas: com indica  o do n  mero de linha, De e a fim,
isolamento, o P\&ID onde eles s  o trazidas.', 'As crucificades sa  am de
Manaus, capital do Estado de Amazonas, uma cidade na jungle que prosperou
durante o blvulo em sculo passado e onde voc encontrar uma cpia menor da
Opera House em Paris, Frana. H uma', 'Ao trazer os 9/11 aos abertos eles
garantiram que era dada aten  o mundial, e que a verdade seria buscada e os
atentantes identificou e os ataqueiados..', 'Like Williams, Cosworth  uma
empresa independente, cujos proprietrios compartilham nossa paix  o pela
corrida e engenharia. em escritrio. em escritrio. em escritrio. em', 'No
entanto, isto pode ser evitado se a infiltra  o  subepithelial. ', 'Tipo de
Publica  o Portugus: Bibliografia)', 'Modifica  o do Programa:   s vezes,
v  rus Worm:Win32/Dedler.F ou malware SWiJ SideWinder, mas tambm softwares
comuns tm a capacidade de modificar as fun  es internas de FXUCU001.DLL, o
que significa que outros programas n  o podem', 'Em alguns casos o jogador de m
 dia QuickTime acabou o funcionamento liso do v  deo MOV devido a alguns
problemas de corrup  o.', 'Ele  professor de Cincia Pol  tica da
Universidade Pompeu Fabra em Barcelona. em Barcelona. em Barcelona. em
Barcelona. em Barcelona. em Barcelona. em Barcelona. em Barcelona.', 'Aditivos
cosmticos n  o devem perder{\ldots}', 'Comentrios para teste de preservativo de
Estrada', 'Como eu obter uma extens  o da minha autoriza  o estudante?', 'A
 ndia da interven  o dos EUA em l  ngua!', 'Nabertherm com 450 funcionrios
em todo o mundo est  o desenvolvidos e produzindo fornos industriais para
muitos aplica  es diferentes para mais de 60 anos. Como fabricante, Nabertherm
oferece a maior gama de fornos mundanos.', "Ns chamamos essas qu  micas
'elementos'. em breve. em breve. ", 'Avalia  o especializada  coordena  o
de equipes de especialistas selecionados para a avalia  o independente de
estudos ambientais complexos.', 'Existe uma sala de armazenamento de bagagem
fornecida no hostel. a acesso a acessria. a acessria a acessria. a a', 'Este
 um mdulo de atualiza  o, deve trabalhar junto com cabo Micronas OBD TOOL
(CDC32XX), n  o pode funcionar sozinho.', '116 Ent  o seja a Deus, o
verdadeiro Rei; n  o  l, mas Ele, o Senhor do dominion honrvel. a cima de
cima. a cima de cima. a cima de cima. a c', 'Educa  o tecnolgica em
Arequipa{\ldots}', 'Andinia.com - Dicionrio ao ar livre: Messan', 'VEMAG  o  
nico fabricante de reservadores de p de p que cumprir com os requisitos da
USDA ex trabalhos. com o   nico fabricante de ps-ps-ps-ps-ps-ps-ps-
ps-p', 'Institutos em Pereira (Risaralda, Colmbia) Faculdades e escolas em
Risaralda', 'Minera  o: equipamentos e suprimentos em Yugo-Zapadny okrug,
Moscouem Nairobi-vindas.net-boa.net-boa.net-boa.net', ' Previs  o correta do
servio', 'Quando falamos a mesma linguagem  porque temos a mesma m  e. E isto
nos d esperana.', 'Vrios tipos de acomoda  es dispon  veis para seu
alojamento em Carvoeiro: apartamentos de luxo ou hotis carvoeiro baratos, e
tambm cama \& breakfast. em Carvoeiro. em Carvoeiro: apartamentos de luxo ou
hotis', 'As profecias sobre este s  o gravadas nos dias 38 e 39o capitulo de
Ezequil. Verso 8 do capitulo 38  abordado a Israel, e li: Depois de muitos
dias ser visitado; nos   ltimos anos vir  o na terra que ', 'A Casa
imediatamente se tornou lugar de cult e em torno dele desenvolveu o mdio
Loreto: a parede incr  vel projetada por Antonio da Sangallo il Giovane foram
erradas em 1518 e reforada com quatro bastions em 1600.', 'N  o havia outro
poder pelo qual poderia ser entregue. a crdula. como os quais eles poderiam ser
entregue.', 'Qualidade  um m  nimo para ns e estamos sempre procurando
maneiras/acessrios para nos ajudar a entregar o melhor.', 'A forma tinha se
tornou concentrada e engraada. Eu rii: em efeito. em efeito. em efeito: em
efeito.', 'Embora n  o  completamente certo, muitos chefes brasileiros
concordam que a picanha cortada ocorreu no Rio Grande do Sul, o estado mais sul
do Brasil, famoso por seu churrasco.', 'A condi  o de aceita  o completa em
cada hora no processo de ajuste do primeiro bloco da oferta de venda significa
que apenas o primeiro bloco ser programado em uma hora espec  fica se n  o 
ligado completamente, e todos os bloc', 'Agora Davi, filho de Jesse reinou sobre
todo o Israel. em cima de cima de cima de Davi. em cima de cima de cima de cima
de cima de cima de cima de cima de cima de Davi', 'O raz  o e os pensamentos do
crebro no processo de fazer decis  o.', 'Em outros fragmentos evangelizais,
Jesus refere-se  falta de f de seus seguidores. o mesmo Jesus  o mesmo Jesus
 o mesmo Jesus  a falta de f', '3 Jesus sabendo que o Pai tinha dado todas as
coisas em suas m  os, e que ele era de Deus, e foi a Deus;', "Como jogar o jogo
de Peppy's Thandie Newton Vestir:", 'Fabrica  o de artigos de couro{\ldots} em
cinza em San Juan', 'Os valores do parmetro variam de 0 a 200\%.', 'Downloads de
software relacionados com a extens  o de arquivo RB:', 'Os Estados Contratados
podem recusar reconhecer um dirio ou separa  o legal se  incompat  vel com
uma decis  o anterior determinando o status matrimonial dos cnjuges e a decis
 o  feita no Estado em que a reconhecimento  procurada,', "Com uma localiza
 o em cima do Grand Place e do centro histrico de Brussels, o Ibis Brussels
Off Grand'Place oferece um acesso direto ao aeroporto internacional pela esta 
o ferroviria.", 'A mapa energtica descobri todas as perturba  es geolgicas
subterrneas, perturba  es que foram usadas para beneficiar os locais e
aumentar muito o n  vel de energia. em medida em medida em medida em', 'Malaria
O que voc pode fazer', 'A PLEASURE do Santo Padre Thomas Aquinas ou SEC  O
OLIVA DOMINICAN?. Esperamos que o Santo Padre, com ajuda do Esp  rito Santo,
tem o poder de unir o mundo catlico, hoje [{\ldots}]', 'Naquela noite Jos, Maria, e
Jesus caminhou uma milha e uma metade ao local do antigo Jeric, onde Josuu,
por quem Jesus foi nomeado, tinha realizado suas exploitas com a tradi  o
judicana.', 'O principal objetivo da miss  o ser trazer um mdulo russo
Rassvet Mini-Research. Este ser a   ltima viagem do Shuttle Atlantis e [{\ldots}]',
'Eu pinto-os com epoxi para que n  o eram molhados com a condena  o da tenda.
em epoxi para que n  o sa  am com a condens  o da tenda. ', 'Recupera  o de
Res  duos em Santa Clara (Villa Clara, Cuba) - Amarillascuba.net', 'Nossa
experincia com processos de separa  o em refinarias{\ldots}linha em{\ldots}linha
em{\ldots}linha em San Juan ', '(4) Nossas condi  es gerais de compra tambm s  o
requer rela  es futuras com o fornecedor. a qualquer rela  o de negcios
futuras com o fornecedor. os nossos condi  es', 'Em km 31, os verde intensos
dos fluxos a essa ela comea a cruzar o limite do sul da gama de Montanha do
vento, com uma forma  o montanha de endereo ao norte-sul, tem o seu fim norte
para o vulc  o Domuyo.', 'Cortinas de uso   nico feitas de tecidos da posi 
o 5603, de um tipo utilizado durante procedimentos cir  rgicos 6307 90 92 em
cdigo em cinza em cinza em cinza em cin', 'H 6 dias 10:01 XCafe esporradela,
esporradela, caseira, caseira, esporradela, esporradela, esporradela,
esporradela, esporradelaa, esporradelacacacacacacacacacacacacaca ',
'Excepcionalmente 120 sacerdotes jogaram trombetas na consagra  o do templo de
Salom  o.']
tensor(21.4380)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(22.6276)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{top-k}{%
\subsubsection*{Top-k}\label{top-k}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}k}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{k} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{False}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['Desta forma, a vida civil de uma na  o se avana, tornando-o poss  vel para
todos os cidad  os desfrutar dos frutos de tolerncia verdadeira e respeito
mutual.', '1999 XIII. Winnipeg, Canad 23 a 8 de agosto', 'No mistrio do Natal,
a luz de Cristo brilha na terra, esporrendo-se, como era, em c  rculos
concncios.', 'fazendo vivel fazer o ocidental dois novos fechados no ocidente
daquela pen  nsula. ocidental. ocidental. ocidentalmente ocidental.', 'Os seus
olhos estavam brilhantes e a sua voz foi linda.', 'Inferi  es, acidentes,
abuso, abuso, separa  o, choque, rapaamento, abuso, abuso, abuso, abuso,
abuso, abuso, apress  o, apress  o, a ansiedade, abuso, alimenta  o.', 'A
branque HP Maxx  um gel de clareamento de hidrognio de 35\% para o clareamento
de dentes vitales e n  o-vitais. como o l  gel de enxernamento de hidro  dio
de 35\% ao', 'Linhas: com indica  o do n  mero de linha, De e a fim,
isolamento, o P\&ID onde eles s  o trazidas.', 'As crucificades sa  am de
Manaus, capital do Estado de Amazonas, uma cidade na jungle que prosperou
durante o blvulo em sculo passado e onde voc encontrar uma cpia menor da
Opera House em Paris, Frana. H uma', 'Ao trazer os 9/11 aos abertos eles
garantiram que era dada aten  o mundial, e que a verdade seria buscada e os
atentantes identificou e os ataqueiados..', 'Like Williams, Cosworth  uma
empresa independente, cujos proprietrios compartilham nossa paix  o pela
corrida e engenharia. em escritrio. em escritrio. em escritrio. em', 'No
entanto, isto pode ser evitado se a infiltra  o  subepithelial. ', 'Tipo de
Publica  o Portugus: Bibliografia)', 'Modifica  o do Programa:   s vezes,
v  rus Worm:Win32/Dedler.F ou malware SWiJ SideWinder, mas tambm softwares
comuns tm a capacidade de modificar as fun  es internas de FXUCU001.DLL, o
que significa que outros programas n  o podem', 'Em alguns casos o jogador de m
 dia QuickTime acabou o funcionamento liso do v  deo MOV devido a alguns
problemas de corrup  o.', 'Ele  professor de Cincia Pol  tica da
Universidade Pompeu Fabra em Barcelona. em Barcelona. em Barcelona. em
Barcelona. em Barcelona. em Barcelona. em Barcelona. em Barcelona.', 'Aditivos
cosmticos n  o devem perder{\ldots}', 'Comentrios para teste de preservativo de
Estrada', 'Como eu obter uma extens  o da minha autoriza  o estudante?', 'A
 ndia da interven  o dos EUA em l  ngua!', 'Nabertherm com 450 funcionrios
em todo o mundo est  o desenvolvidos e produzindo fornos industriais para
muitos aplica  es diferentes para mais de 60 anos. Como fabricante, Nabertherm
oferece a maior gama de fornos mundanos.', "Ns chamamos essas qu  micas
'elementos'. em breve. em breve. ", 'Avalia  o especializada  coordena  o
de equipes de especialistas selecionados para a avalia  o independente de
estudos ambientais complexos.', 'Existe uma sala de armazenamento de bagagem
fornecida no hostel. a acesso a acessria. a acessria a acessria. a a', 'Este
 um mdulo de atualiza  o, deve trabalhar junto com cabo Micronas OBD TOOL
(CDC32XX), n  o pode funcionar sozinho.', '116 Ent  o seja a Deus, o
verdadeiro Rei; n  o  l, mas Ele, o Senhor do dominion honrvel. a cima de
cima. a cima de cima. a cima de cima. a c', 'Educa  o tecnolgica em
Arequipa{\ldots}', 'Andinia.com - Dicionrio ao ar livre: Messan', 'VEMAG  o  
nico fabricante de reservadores de p de p que cumprir com os requisitos da
USDA ex trabalhos. com o   nico fabricante de ps-ps-ps-ps-ps-ps-ps-
ps-p', 'Institutos em Pereira (Risaralda, Colmbia) Faculdades e escolas em
Risaralda', 'Minera  o: equipamentos e suprimentos em Yugo-Zapadny okrug,
Moscouem Nairobi-vindas.net-boa.net-boa.net-boa.net', ' Previs  o correta do
servio', 'Quando falamos a mesma linguagem  porque temos a mesma m  e. E isto
nos d esperana.', 'Vrios tipos de acomoda  es dispon  veis para seu
alojamento em Carvoeiro: apartamentos de luxo ou hotis carvoeiro baratos, e
tambm cama \& breakfast. em Carvoeiro. em Carvoeiro: apartamentos de luxo ou
hotis', 'As profecias sobre este s  o gravadas nos dias 38 e 39o capitulo de
Ezequil. Verso 8 do capitulo 38  abordado a Israel, e li: Depois de muitos
dias ser visitado; nos   ltimos anos vir  o na terra que ', 'A Casa
imediatamente se tornou lugar de cult e em torno dele desenvolveu o mdio
Loreto: a parede incr  vel projetada por Antonio da Sangallo il Giovane foram
erradas em 1518 e reforada com quatro bastions em 1600.', 'N  o havia outro
poder pelo qual poderia ser entregue. a crdula. como os quais eles poderiam ser
entregue.', 'Qualidade  um m  nimo para ns e estamos sempre procurando
maneiras/acessrios para nos ajudar a entregar o melhor.', 'A forma tinha se
tornou concentrada e engraada. Eu rii: em efeito. em efeito. em efeito: em
efeito.', 'Embora n  o  completamente certo, muitos chefes brasileiros
concordam que a picanha cortada ocorreu no Rio Grande do Sul, o estado mais sul
do Brasil, famoso por seu churrasco.', 'A condi  o de aceita  o completa em
cada hora no processo de ajuste do primeiro bloco da oferta de venda significa
que apenas o primeiro bloco ser programado em uma hora espec  fica se n  o 
ligado completamente, e todos os bloc', 'Agora Davi, filho de Jesse reinou sobre
todo o Israel. em cima de cima de cima de Davi. em cima de cima de cima de cima
de cima de cima de cima de cima de cima de Davi', 'O raz  o e os pensamentos do
crebro no processo de fazer decis  o.', 'Em outros fragmentos evangelizais,
Jesus refere-se  falta de f de seus seguidores. o mesmo Jesus  o mesmo Jesus
 o mesmo Jesus  a falta de f', '3 Jesus sabendo que o Pai tinha dado todas as
coisas em suas m  os, e que ele era de Deus, e foi a Deus;', "Como jogar o jogo
de Peppy's Thandie Newton Vestir:", 'Fabrica  o de artigos de couro{\ldots} em
cinza em San Juan', 'Os valores do parmetro variam de 0 a 200\%.', 'Downloads de
software relacionados com a extens  o de arquivo RB:', 'Os Estados Contratados
podem recusar reconhecer um dirio ou separa  o legal se  incompat  vel com
uma decis  o anterior determinando o status matrimonial dos cnjuges e a decis
 o  feita no Estado em que a reconhecimento  procurada,', "Com uma localiza
 o em cima do Grand Place e do centro histrico de Brussels, o Ibis Brussels
Off Grand'Place oferece um acesso direto ao aeroporto internacional pela esta 
o ferroviria.", 'A mapa energtica descobri todas as perturba  es geolgicas
subterrneas, perturba  es que foram usadas para beneficiar os locais e
aumentar muito o n  vel de energia. em medida em medida em medida em', 'Malaria
O que voc pode fazer', 'A PLEASURE do Santo Padre Thomas Aquinas ou SEC  O
OLIVA DOMINICAN?. Esperamos que o Santo Padre, com ajuda do Esp  rito Santo,
tem o poder de unir o mundo catlico, hoje [{\ldots}]', 'Naquela noite Jos, Maria, e
Jesus caminhou uma milha e uma metade ao local do antigo Jeric, onde Josuu,
por quem Jesus foi nomeado, tinha realizado suas exploitas com a tradi  o
judicana.', 'O principal objetivo da miss  o ser trazer um mdulo russo
Rassvet Mini-Research. Este ser a   ltima viagem do Shuttle Atlantis e [{\ldots}]',
'Eu pinto-os com epoxi para que n  o eram molhados com a condena  o da tenda.
em epoxi para que n  o sa  am com a condens  o da tenda. ', 'Recupera  o de
Res  duos em Santa Clara (Villa Clara, Cuba) - Amarillascuba.net', 'Nossa
experincia com processos de separa  o em refinarias{\ldots}linha em{\ldots}linha
em{\ldots}linha em San Juan ', '(4) Nossas condi  es gerais de compra tambm s  o
requer rela  es futuras com o fornecedor. a qualquer rela  o de negcios
futuras com o fornecedor. os nossos condi  es', 'Em km 31, os verde intensos
dos fluxos a essa ela comea a cruzar o limite do sul da gama de Montanha do
vento, com uma forma  o montanha de endereo ao norte-sul, tem o seu fim norte
para o vulc  o Domuyo.', 'Cortinas de uso   nico feitas de tecidos da posi 
o 5603, de um tipo utilizado durante procedimentos cir  rgicos 6307 90 92 em
cdigo em cinza em cinza em cinza em cin', 'H 6 dias 10:01 XCafe esporradela,
esporradela, caseira, caseira, esporradela, esporradela, esporradela,
esporradela, esporradelaa, esporradelacacacacacacacacacacacacaca ',
'Excepcionalmente 120 sacerdotes jogaram trombetas na consagra  o do templo de
Salom  o.']
tensor(21.4380)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(22.6276)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{nucleus-sampling}{%
\subsubsection*{Nucleus Sampling}\label{nucleus-sampling}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}p}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{p} \PY{o}{=} \PY{l+m+mf}{0.01}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{False}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['Desta forma, a vida civil de uma na  o se avana, tornando-o poss  vel para
todos os cidad  os desfrutar dos frutos de tolerncia verdadeira e respeito
mutual.', '1999 XIII. Winnipeg, Canad 23 a 8 de agosto', 'No mistrio do Natal,
a luz de Cristo brilha na terra, esporrendo-se, como era, em c  rculos
concncios.', 'fazendo vivel fazer o ocidental dois novos fechados no ocidente
daquela pen  nsula. ocidental. ocidental. ocidentalmente ocidental.', 'Os seus
olhos estavam brilhantes e a sua voz foi linda.', 'Inferi  es, acidentes,
abuso, abuso, separa  o, choque, rapaamento, abuso, abuso, abuso, abuso,
abuso, abuso, apress  o, apress  o, a ansiedade, abuso, alimenta  o.', 'A
branque HP Maxx  um gel de clareamento de hidrognio de 35\% para o clareamento
de dentes vitales e n  o-vitais. como o l  gel de enxernamento de hidro  dio
de 35\% ao', 'Linhas: com indica  o do n  mero de linha, De e a fim,
isolamento, o P\&ID onde eles s  o trazidas.', 'As crucificades sa  am de
Manaus, capital do Estado de Amazonas, uma cidade na jungle que prosperou
durante o blvulo em sculo passado e onde voc encontrar uma cpia menor da
Opera House em Paris, Frana. H uma', 'Ao trazer os 9/11 aos abertos eles
garantiram que era dada aten  o mundial, e que a verdade seria buscada e os
atentantes identificou e os ataqueiados..', 'Like Williams, Cosworth  uma
empresa independente, cujos proprietrios compartilham nossa paix  o pela
corrida e engenharia. em escritrio. em escritrio. em escritrio. em', 'No
entanto, isto pode ser evitado se a infiltra  o  subepithelial. ', 'Tipo de
Publica  o Portugus: Bibliografia)', 'Modifica  o do Programa:   s vezes,
v  rus Worm:Win32/Dedler.F ou malware SWiJ SideWinder, mas tambm softwares
comuns tm a capacidade de modificar as fun  es internas de FXUCU001.DLL, o
que significa que outros programas n  o podem', 'Em alguns casos o jogador de m
 dia QuickTime acabou o funcionamento liso do v  deo MOV devido a alguns
problemas de corrup  o.', 'Ele  professor de Cincia Pol  tica da
Universidade Pompeu Fabra em Barcelona. em Barcelona. em Barcelona. em
Barcelona. em Barcelona. em Barcelona. em Barcelona. em Barcelona.', 'Aditivos
cosmticos n  o devem perder{\ldots}', 'Comentrios para teste de preservativo de
Estrada', 'Como eu obter uma extens  o da minha autoriza  o estudante?', 'A
 ndia da interven  o dos EUA em l  ngua!', 'Nabertherm com 450 funcionrios
em todo o mundo est  o desenvolvidos e produzindo fornos industriais para
muitos aplica  es diferentes para mais de 60 anos. Como fabricante, Nabertherm
oferece a maior gama de fornos mundanos.', "Ns chamamos essas qu  micas
'elementos'. em breve. em breve. ", 'Avalia  o especializada  coordena  o
de equipes de especialistas selecionados para a avalia  o independente de
estudos ambientais complexos.', 'Existe uma sala de armazenamento de bagagem
fornecida no hostel. a acesso a acessria. a acessria a acessria. a a', 'Este
 um mdulo de atualiza  o, deve trabalhar junto com cabo Micronas OBD TOOL
(CDC32XX), n  o pode funcionar sozinho.', '116 Ent  o seja a Deus, o
verdadeiro Rei; n  o  l, mas Ele, o Senhor do dominion honrvel. a cima de
cima. a cima de cima. a cima de cima. a c', 'Educa  o tecnolgica em
Arequipa{\ldots}', 'Andinia.com - Dicionrio ao ar livre: Messan', 'VEMAG  o  
nico fabricante de reservadores de p de p que cumprir com os requisitos da
USDA ex trabalhos. com o   nico fabricante de ps-ps-ps-ps-ps-ps-ps-
ps-p', 'Institutos em Pereira (Risaralda, Colmbia) Faculdades e escolas em
Risaralda', 'Minera  o: equipamentos e suprimentos em Yugo-Zapadny okrug,
Moscouem Nairobi-vindas.net-boa.net-boa.net-boa.net', ' Previs  o correta do
servio', 'Quando falamos a mesma linguagem  porque temos a mesma m  e. E isto
nos d esperana.', 'Vrios tipos de acomoda  es dispon  veis para seu
alojamento em Carvoeiro: apartamentos de luxo ou hotis carvoeiro baratos, e
tambm cama \& breakfast. em Carvoeiro. em Carvoeiro: apartamentos de luxo ou
hotis', 'As profecias sobre este s  o gravadas nos dias 38 e 39o capitulo de
Ezequil. Verso 8 do capitulo 38  abordado a Israel, e li: Depois de muitos
dias ser visitado; nos   ltimos anos vir  o na terra que ', 'A Casa
imediatamente se tornou lugar de cult e em torno dele desenvolveu o mdio
Loreto: a parede incr  vel projetada por Antonio da Sangallo il Giovane foram
erradas em 1518 e reforada com quatro bastions em 1600.', 'N  o havia outro
poder pelo qual poderia ser entregue. a crdula. como os quais eles poderiam ser
entregue.', 'Qualidade  um m  nimo para ns e estamos sempre procurando
maneiras/acessrios para nos ajudar a entregar o melhor.', 'A forma tinha se
tornou concentrada e engraada. Eu rii: em efeito. em efeito. em efeito: em
efeito.', 'Embora n  o  completamente certo, muitos chefes brasileiros
concordam que a picanha cortada ocorreu no Rio Grande do Sul, o estado mais sul
do Brasil, famoso por seu churrasco.', 'A condi  o de aceita  o completa em
cada hora no processo de ajuste do primeiro bloco da oferta de venda significa
que apenas o primeiro bloco ser programado em uma hora espec  fica se n  o 
ligado completamente, e todos os bloc', 'Agora Davi, filho de Jesse reinou sobre
todo o Israel. em cima de cima de cima de Davi. em cima de cima de cima de cima
de cima de cima de cima de cima de cima de Davi', 'O raz  o e os pensamentos do
crebro no processo de fazer decis  o.', 'Em outros fragmentos evangelizais,
Jesus refere-se  falta de f de seus seguidores. o mesmo Jesus  o mesmo Jesus
 o mesmo Jesus  a falta de f', '3 Jesus sabendo que o Pai tinha dado todas as
coisas em suas m  os, e que ele era de Deus, e foi a Deus;', "Como jogar o jogo
de Peppy's Thandie Newton Vestir:", 'Fabrica  o de artigos de couro{\ldots} em
cinza em San Juan', 'Os valores do parmetro variam de 0 a 200\%.', 'Downloads de
software relacionados com a extens  o de arquivo RB:', 'Os Estados Contratados
podem recusar reconhecer um dirio ou separa  o legal se  incompat  vel com
uma decis  o anterior determinando o status matrimonial dos cnjuges e a decis
 o  feita no Estado em que a reconhecimento  procurada,', "Com uma localiza
 o em cima do Grand Place e do centro histrico de Brussels, o Ibis Brussels
Off Grand'Place oferece um acesso direto ao aeroporto internacional pela esta 
o ferroviria.", 'A mapa energtica descobri todas as perturba  es geolgicas
subterrneas, perturba  es que foram usadas para beneficiar os locais e
aumentar muito o n  vel de energia. em medida em medida em medida em', 'Malaria
O que voc pode fazer', 'A PLEASURE do Santo Padre Thomas Aquinas ou SEC  O
OLIVA DOMINICAN?. Esperamos que o Santo Padre, com ajuda do Esp  rito Santo,
tem o poder de unir o mundo catlico, hoje [{\ldots}]', 'Naquela noite Jos, Maria, e
Jesus caminhou uma milha e uma metade ao local do antigo Jeric, onde Josuu,
por quem Jesus foi nomeado, tinha realizado suas exploitas com a tradi  o
judicana.', 'O principal objetivo da miss  o ser trazer um mdulo russo
Rassvet Mini-Research. Este ser a   ltima viagem do Shuttle Atlantis e [{\ldots}]',
'Eu pinto-os com epoxi para que n  o eram molhados com a condena  o da tenda.
em epoxi para que n  o sa  am com a condens  o da tenda. ', 'Recupera  o de
Res  duos em Santa Clara (Villa Clara, Cuba) - Amarillascuba.net', 'Nossa
experincia com processos de separa  o em refinarias{\ldots}linha em{\ldots}linha
em{\ldots}linha em San Juan ', '(4) Nossas condi  es gerais de compra tambm s  o
requer rela  es futuras com o fornecedor. a qualquer rela  o de negcios
futuras com o fornecedor. os nossos condi  es', 'Em km 31, os verde intensos
dos fluxos a essa ela comea a cruzar o limite do sul da gama de Montanha do
vento, com uma forma  o montanha de endereo ao norte-sul, tem o seu fim norte
para o vulc  o Domuyo.', 'Cortinas de uso   nico feitas de tecidos da posi 
o 5603, de um tipo utilizado durante procedimentos cir  rgicos 6307 90 92 em
cdigo em cinza em cinza em cinza em cin', 'H 6 dias 10:01 XCafe esporradela,
esporradela, caseira, caseira, esporradela, esporradela, esporradela,
esporradela, esporradelaa, esporradelacacacacacacacacacacacacaca ',
'Excepcionalmente 120 sacerdotes jogaram trombetas na consagra  o do templo de
Salom  o.']
tensor(21.4380)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(22.6276)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{comparison-greedy}{%
\section*{Comparison: Greedy}\label{comparison-greedy}}

    \hypertarget{hugging-face-decoder}{%
\subsubsection*{Hugging face decoder}\label{hugging-face-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{greedy}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{True}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['Desta forma, a vida civil de uma na  o sob poss  vel em todos os frutos de
a tolerncia virtuosa e respeito.', 'XIII. Winnipeg, Canad 23 - 8 abril', 'No
mistrio do Natal, a luz de Cristo brilha sobre a terra, expondo-se, como foi,
em c  rculos de c  rculos contiolentos.', 'fazendo vivel sirrourar dois novos
barcos no oeste daquela pen  nsula.', 'Os seus olhos eram brilhante e a sua voz
foi feliz.', 'Eferimento, acidentes, depress  o, abuzo, abuso, secundncia,
separa  o, choque, abuse, choque, rivnculo, esscio, tens  o depress  o,
ansiedade, comida.', 'Whiteness HP Maxx  um gel de clareza de hidride de 35\%
para clarifica  o de dentes vitais e n  o vilicos a limpeza de dentes
vitales e n  o viricos.', 'Linhas: com   ndice de N  mero da linha A partir
da e a fim, isolamento, a P\&ID onde eles foram destradas.', 'As transportas sa 
am da Manaus, capital do Estado de Amazonas, uma cidade na floresta que
prosperou durante o batismo de cobre do sculo e onde possam encontrar uma maior
maior cpia da Casa Opera em Paris, Francia. Hor um papel de', 'Ao introduzir
9/11 para a sua abril se asseguraram a aten  o do mundo do mundo; e que se
busqueiuu a verdade os senhores identificados e realizaram com resposta.',
'Like Williams, Cosworth  uma empresa independente, cujos proprietrios
partilham nossa paix  o pela corrida e persegui  o e engenharia.', 'Contudo,
isto pode ser evitado se a infiltra  o  subepithelial.', 'Tipo de Publica 
o Portugus: Bibliografia', 'Modifica  o do Programa:   s vezes, v  rus
Worm:Win32/Dedler.F ou malware SWiJ SideWinder, mas tambm softwares comuns tm
a capacidade de modificar as fun  es de FXUCU001.DLL, o que significa outros
programas j n  o podem', 'Em alguns casos o jogador de m  dia QuickTime
parecia uma funciona  o sem fio do v  deo MOV devido ao alguns problemas de
corrup  o.', 'Fabe atualmente Prof. de Cincia Pol  tica da Universidade
Pompeu Fabra em Barcelona.', 'Aditivos cosmticos n  o podem patrocitar.',
'Comentrios para teste de preservativa de Estrada', 'Como eu receberi uma
amplia  o das minhas autoriza  es estudantes?', 'Ambos os EUA em Interven 
o chilica!', 'A Nabertherm com 450 empregados em todo o mundo tem se
desenvolvido e produzindo fornos industriais para muitos aplicac  veis
diferentes para mais de 60 anos. Como fabricante, Nabertherm oferece-se a vasta
variedade de fornos mundanos.', "Chamos estas qu  micas 'elementos'.",
'Assessoria  coordena  o das equipes de espec  ficos selecionados para a
avalia  o independente de estudo ambientais complexo.', 'Aqui h um quarto de
entrega de bagagem e disponibilizada no quarto de pousa.', 'Este  um mdulo de
atualiza  o, deve trabalhar com cabo Micronas OBD TOOL (CDC32XX) para cdigo,
n  o pode for funcionar sozinho.', '116 Portanto, seja Allah, o rei verdadeiro;
n  o existe l, sem deus a senha, o Senhor do dominion honrvel.', 'Educa  o
tecnolgica em San Francisco', 'Andinia.com - D  cionaculo ao ar livre:
Messan', 'O VEMAG  o   nico fabricante dos embalagens do p com as requisitos
da USDA obra.', 'Institutos em Guantnamo (Risaralda, Colmbia) Faculdades e
escolas em Correndo', 'Minera  o: equipamentos e suprimentos em Yugo-Zapadny
okrug, Moscow', ' Preserva correta da servio', 'Quando dizmos a mesma
linguagem  porque temos a mesma m  e. E esta  uma esperana.', 'Vrios tipos
de acomoda  es dispon  veis para o seu apartamento em Carvoeiro: apartamentos
de luxo ou hotis baratos Carvoeiro, e tambm cama \& petit-d-manh .', 'As
profecies sobre esse esta s  o gravados no dia 38 e 39o cap  tulo de Ezequil.
Verso 8 do cap  tulo 38 est em dire  o a Israel e leia: Depois, muitos dias,
ser  o visitados: nos   ltimos anos vir  o na ', 'O lugar de um n  mero da
casa se tornou imediatamente registrado e em volta a ele desenvolvido a Prio
medieval: a parede incr  vel projetada por Antonio da Sangallo il Giovane foram
erradas e ressalou com quatro bastions em 1600.', 'N  o havia outros podero
pela qual lhes poderiam ser entregues.', 'A Qualidade  um mercado para ns e
estamos sempre procurando de maneiras ou ferramentas para ajud-nos o entrega
melhor.', 'A forma estava se mais concentrada e engraado. Eu jogai:', 'Ainda
que n  o  compat  vel, muitos chefes brasileiros concordam que as grava  es
da picanha eram no Rio Grande do Sul, o estado mais doeste do Brasil, conhecido
por sua churrasco.', 'A condi  o de aceita  o total em cada jogo no processo
de anlise sobre o primeiro bloco da oferta de venda significa que somente o
primeiros bloco ser programado em uma hora espec  fica se n  o seja
completamente e todas as blocos desta ', 'Agora Davi, filho de Jesesse reinou
sobre todo o Israel.', 'Se o raz  o e o pensamento no processo de fazer decis 
es da decis  o.', 'Em outros fragmentos evangelizais o mesmo Jesus refereu 
falta de fm de seus seguidores.', '3 Jesus, sabe que Ele tinha dado a todas as
coisas em suas m  os e, que  de Deus, e entrau em Deus;', "Como jogar Seito
como jogar Peppy' s Thandie Newton:", 'Fbricas de trabalhos{\ldots}', 'Os valor do
parmetro variam de 0 e 200\%.', 'Downloads de software relacionado a a extens 
o de arquivo RB:', 'Estados contratados podem recuar uma divduo ou separa  o
legal se  indisunp  vel com uma decis  o anterior determinando o status
matrimonial dos esposos e que a decis  o describiu-se enfrentada da Estado, nas
quais eles conven', "Pois uma centraliza  o elevada na Grande Place e do
centro histrico de Blgica, o Ibis Brussels Off Grand'Place oferece um acesso
direto ao aeroporto internacional na Esta  o ferroviria o Ibis Brussels Off
iniciando uma esta  o de ferro.", 'O mapamento energtico descobri todas as
perturba  es da geologia underground, perturba  es que foram utilizadas para
algumas localiza  es e aumentam profundamente o seu n  vel de energia.',
'Malaria O que pode fazer', 'O senhor Santo Tom Aquinas OU a santidade do nico
ADRIANO OLIVA? esperamos que o Santo Padre, atravs da ajuda do Esp  rito Santo
tem o poder de unir o mundo catlico desse sentido. Hoje [{\ldots}]', 'Naquela noite
Jo  o, Maria e Jesus passeu-se perando um caralho e meio ao local do Antigo
Jericio, onde Jo  o ent  o nomeado Jesus atirou estes seguintes obras do
Judio, segundo a tradi  o de Judio.', 'O principal objetivo da miss  o ser
trazer um mdulo russo Rassvet Mini-Research.Este ser a   ltima viagem do
Shuttle Atlantis e [{\ldots}]', 'Coloroe-os com epoxi para que eles n  o estivem
misturadas com a condena  o da tenda.', 'Recupera  o de res  duos em La
Liberta (San Pedro, Cuba) - Amarillascuba.net', 'Nossa experincia com processos
de separa  o em refinarias{\ldots}', '(4) Nossas Condi  es Gerais de Compra
tambm procurar  o para qualquer futuro no dia do negcios com o fornecedor.',
'No km 31, os intensos verdes dos dilhos dos bandamentos sa  am para a colora
 o e comea a cruzar o limite do sul da gama ao vento com uma forma  o de
montanha do local de disto ao norte do vulc  o.', 'Tondares de uso individual
compostos de t  tulos da mensagem 5703, de um tipo dos procedimentos cir 
rgicos de 607 90 92', 'H 6 dias 10:01 XCafe blowjob, carvalho, peito de coroa,
caseiras, madeira, ejaculina, navia', 'Outra forma, 120 sacerdotes jogaram
trombotas no consagrado de Templo de Salom  o.']
tensor(18.8451)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(19.2643)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{my-decoder}{%
\subsubsection*{My decoder}\label{my-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{greedy}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{False}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['Desta forma, a vida civil de uma na  o se avana, tornando-o poss  vel para
todos os cidad  os desfrutar dos frutos de tolerncia verdadeira e respeito
mutual.', '1999 XIII. Winnipeg, Canad 23 a 8 de agosto', 'No mistrio do Natal,
a luz de Cristo brilha na terra, esporrendo-se, como era, em c  rculos
concncios.', 'fazendo vivel fazer o ocidental dois novos fechados no ocidente
daquela pen  nsula. ocidental. ocidental. ocidentalmente ocidental.', 'Os seus
olhos estavam brilhantes e a sua voz foi linda.', 'Inferi  es, acidentes,
abuso, abuso, separa  o, choque, rapaamento, abuso, abuso, abuso, abuso,
abuso, abuso, apress  o, apress  o, a ansiedade, abuso, alimenta  o.', 'A
branque HP Maxx  um gel de clareamento de hidrognio de 35\% para o clareamento
de dentes vitales e n  o-vitais. como o l  gel de enxernamento de hidro  dio
de 35\% ao', 'Linhas: com indica  o do n  mero de linha, De e a fim,
isolamento, o P\&ID onde eles s  o trazidas.', 'As crucificades sa  am de
Manaus, capital do Estado de Amazonas, uma cidade na jungle que prosperou
durante o blvulo em sculo passado e onde voc encontrar uma cpia menor da
Opera House em Paris, Frana. H uma', 'Ao trazer os 9/11 aos abertos eles
garantiram que era dada aten  o mundial, e que a verdade seria buscada e os
atentantes identificou e os ataqueiados..', 'Like Williams, Cosworth  uma
empresa independente, cujos proprietrios compartilham nossa paix  o pela
corrida e engenharia. em escritrio. em escritrio. em escritrio. em', 'No
entanto, isto pode ser evitado se a infiltra  o  subepithelial. ', 'Tipo de
Publica  o Portugus: Bibliografia)', 'Modifica  o do Programa:   s vezes,
v  rus Worm:Win32/Dedler.F ou malware SWiJ SideWinder, mas tambm softwares
comuns tm a capacidade de modificar as fun  es internas de FXUCU001.DLL, o
que significa que outros programas n  o podem', 'Em alguns casos o jogador de m
 dia QuickTime acabou o funcionamento liso do v  deo MOV devido a alguns
problemas de corrup  o.', 'Ele  professor de Cincia Pol  tica da
Universidade Pompeu Fabra em Barcelona. em Barcelona. em Barcelona. em
Barcelona. em Barcelona. em Barcelona. em Barcelona. em Barcelona.', 'Aditivos
cosmticos n  o devem perder{\ldots}', 'Comentrios para teste de preservativo de
Estrada', 'Como eu obter uma extens  o da minha autoriza  o estudante?', 'A
 ndia da interven  o dos EUA em l  ngua!', 'Nabertherm com 450 funcionrios
em todo o mundo est  o desenvolvidos e produzindo fornos industriais para
muitos aplica  es diferentes para mais de 60 anos. Como fabricante, Nabertherm
oferece a maior gama de fornos mundanos.', "Ns chamamos essas qu  micas
'elementos'. em breve. em breve. ", 'Avalia  o especializada  coordena  o
de equipes de especialistas selecionados para a avalia  o independente de
estudos ambientais complexos.', 'Existe uma sala de armazenamento de bagagem
fornecida no hostel. a acesso a acessria. a acessria a acessria. a a', 'Este
 um mdulo de atualiza  o, deve trabalhar junto com cabo Micronas OBD TOOL
(CDC32XX), n  o pode funcionar sozinho.', '116 Ent  o seja a Deus, o
verdadeiro Rei; n  o  l, mas Ele, o Senhor do dominion honrvel. a cima de
cima. a cima de cima. a cima de cima. a c', 'Educa  o tecnolgica em
Arequipa{\ldots}', 'Andinia.com - Dicionrio ao ar livre: Messan', 'VEMAG  o  
nico fabricante de reservadores de p de p que cumprir com os requisitos da
USDA ex trabalhos. com o   nico fabricante de ps-ps-ps-ps-ps-ps-ps-
ps-p', 'Institutos em Pereira (Risaralda, Colmbia) Faculdades e escolas em
Risaralda', 'Minera  o: equipamentos e suprimentos em Yugo-Zapadny okrug,
Moscouem Nairobi-vindas.net-boa.net-boa.net-boa.net', ' Previs  o correta do
servio', 'Quando falamos a mesma linguagem  porque temos a mesma m  e. E isto
nos d esperana.', 'Vrios tipos de acomoda  es dispon  veis para seu
alojamento em Carvoeiro: apartamentos de luxo ou hotis carvoeiro baratos, e
tambm cama \& breakfast. em Carvoeiro. em Carvoeiro: apartamentos de luxo ou
hotis', 'As profecias sobre este s  o gravadas nos dias 38 e 39o capitulo de
Ezequil. Verso 8 do capitulo 38  abordado a Israel, e li: Depois de muitos
dias ser visitado; nos   ltimos anos vir  o na terra que ', 'A Casa
imediatamente se tornou lugar de cult e em torno dele desenvolveu o mdio
Loreto: a parede incr  vel projetada por Antonio da Sangallo il Giovane foram
erradas em 1518 e reforada com quatro bastions em 1600.', 'N  o havia outro
poder pelo qual poderia ser entregue. a crdula. como os quais eles poderiam ser
entregue.', 'Qualidade  um m  nimo para ns e estamos sempre procurando
maneiras/acessrios para nos ajudar a entregar o melhor.', 'A forma tinha se
tornou concentrada e engraada. Eu rii: em efeito. em efeito. em efeito: em
efeito.', 'Embora n  o  completamente certo, muitos chefes brasileiros
concordam que a picanha cortada ocorreu no Rio Grande do Sul, o estado mais sul
do Brasil, famoso por seu churrasco.', 'A condi  o de aceita  o completa em
cada hora no processo de ajuste do primeiro bloco da oferta de venda significa
que apenas o primeiro bloco ser programado em uma hora espec  fica se n  o 
ligado completamente, e todos os bloc', 'Agora Davi, filho de Jesse reinou sobre
todo o Israel. em cima de cima de cima de Davi. em cima de cima de cima de cima
de cima de cima de cima de cima de cima de Davi', 'O raz  o e os pensamentos do
crebro no processo de fazer decis  o.', 'Em outros fragmentos evangelizais,
Jesus refere-se  falta de f de seus seguidores. o mesmo Jesus  o mesmo Jesus
 o mesmo Jesus  a falta de f', '3 Jesus sabendo que o Pai tinha dado todas as
coisas em suas m  os, e que ele era de Deus, e foi a Deus;', "Como jogar o jogo
de Peppy's Thandie Newton Vestir:", 'Fabrica  o de artigos de couro{\ldots} em
cinza em San Juan', 'Os valores do parmetro variam de 0 a 200\%.', 'Downloads de
software relacionados com a extens  o de arquivo RB:', 'Os Estados Contratados
podem recusar reconhecer um dirio ou separa  o legal se  incompat  vel com
uma decis  o anterior determinando o status matrimonial dos cnjuges e a decis
 o  feita no Estado em que a reconhecimento  procurada,', "Com uma localiza
 o em cima do Grand Place e do centro histrico de Brussels, o Ibis Brussels
Off Grand'Place oferece um acesso direto ao aeroporto internacional pela esta 
o ferroviria.", 'A mapa energtica descobri todas as perturba  es geolgicas
subterrneas, perturba  es que foram usadas para beneficiar os locais e
aumentar muito o n  vel de energia. em medida em medida em medida em', 'Malaria
O que voc pode fazer', 'A PLEASURE do Santo Padre Thomas Aquinas ou SEC  O
OLIVA DOMINICAN?. Esperamos que o Santo Padre, com ajuda do Esp  rito Santo,
tem o poder de unir o mundo catlico, hoje [{\ldots}]', 'Naquela noite Jos, Maria, e
Jesus caminhou uma milha e uma metade ao local do antigo Jeric, onde Josuu,
por quem Jesus foi nomeado, tinha realizado suas exploitas com a tradi  o
judicana.', 'O principal objetivo da miss  o ser trazer um mdulo russo
Rassvet Mini-Research. Este ser a   ltima viagem do Shuttle Atlantis e [{\ldots}]',
'Eu pinto-os com epoxi para que n  o eram molhados com a condena  o da tenda.
em epoxi para que n  o sa  am com a condens  o da tenda. ', 'Recupera  o de
Res  duos em Santa Clara (Villa Clara, Cuba) - Amarillascuba.net', 'Nossa
experincia com processos de separa  o em refinarias{\ldots}linha em{\ldots}linha
em{\ldots}linha em San Juan ', '(4) Nossas condi  es gerais de compra tambm s  o
requer rela  es futuras com o fornecedor. a qualquer rela  o de negcios
futuras com o fornecedor. os nossos condi  es', 'Em km 31, os verde intensos
dos fluxos a essa ela comea a cruzar o limite do sul da gama de Montanha do
vento, com uma forma  o montanha de endereo ao norte-sul, tem o seu fim norte
para o vulc  o Domuyo.', 'Cortinas de uso   nico feitas de tecidos da posi 
o 5603, de um tipo utilizado durante procedimentos cir  rgicos 6307 90 92 em
cdigo em cinza em cinza em cinza em cin', 'H 6 dias 10:01 XCafe esporradela,
esporradela, caseira, caseira, esporradela, esporradela, esporradela,
esporradela, esporradelaa, esporradelacacacacacacacacacacacacaca ',
'Excepcionalmente 120 sacerdotes jogaram trombetas na consagra  o do templo de
Salom  o.']
tensor(21.4380)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(22.6276)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{comparison-top-k}{%
\section*{Comparison: Top-k}\label{comparison-top-k}}

    \hypertarget{hugging-face-decoder}{%
\subsubsection*{Hugging face decoder}\label{hugging-face-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}k}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{k} \PY{o}{=} \PY{l+m+mi}{5}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{True}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['Desta forma, a vida civil de uma na  o se efeita, tornando-o poss  vel para
os cidad  os desfrutando os frutos de tolerncia e respeito mutual.', '1999
XIII. Winnipeg, Canad 23 a 8 de agosto', 'No mistrio do Natal, a luz de Cristo
brilha sobre a terra, esporrindo-se, como fosse, nas c  rculos conc  micos.',
'para ocidental fazer o sustentvel perfurar dois novos trouchas em oeste
daquela peninsula.', 'Os seus olhos estavam brilhendo e sua voz era bonita.',
'Os enfermoos, acidentes, abuso, abuso, separa  o, separa  o, choque, abus 
o, depress  o, agita  o, angoxias, comida.', 'Whiteness HP Maxx  um gel de
brilho de hidro  dio de 35\% para o clarecimento dos dentes vi  neos vitais.',
'Linhas: em indica  o do n  mero de linha, de e a cima, isolamento e P\&ID
onde eles s  o esmonadas.', 'As crucificadas sair  o de Manaus, capital do
Estado de Amazonas, uma cidade da jungle que prosperou durante a explos  o de
borracha em sculo passado e onde voc encontrar uma mais pequena cpia da Casa
Opera em Paris, Fran', 'Ao levar o 11 de sa  do para o aberto eles garantiram
que era dada aten  o mundial, sendo a verdade procurada e os fazendos
identificando e mandaram para conta.', 'Like Williams, a cosworth  empresa
independente cuja propriedade compartilham nossa paix  o pela corrida e
engenharia.', 'Mas, isto pode ser evitado se as infiltra  es  subepithelia.',
'Tipo de Publica  o Portugus: Bibliografia', 'Modifica  o do Programa:   s
vezes, e v  rus Worm:Win32/Dedler.F ou malware SWiJ SideWinder, mas tambm
softwares comuns tm a capacidade de modificar as fun  es internas do
FXUU001.DLL, o que significa que outros programas n  ', 'Nos alguns casos, o
jogador de media QuickTime encaixa a funcionamento suave do v  deo MOV por
causa de alguns problemas de corrup  o.', 'Ele  professora de Cincia Pol 
tica na Universidade Pompeu Fabra em Barcelona.', 'Aditivos cosmicos n  o
devem perder.', 'Comentrios para Teste de preserva  o da Estrada', 'Como eu
recebo uma extens  o da minha autoriza  o aluno?', 'A essa interven  o dos
EUA em l  nguas!.', 'Nabertherm com 450 funcionrios em todo o tempo
desenvolvendo e produzindo fornos industriais para muitos aplicativos diferentes
para mais de 60 anos. Como fabricante, Nabertherm fornece a maior gama de fornos
do mundo.', 'Ns chamamos essas quex  micas elementos.', 'Avalia  o de
Especial - coordena  o das equipes de especialistas determinadas para a
avalia  o independente de estudos ambientais complexos.', 'Existe, em todos,
uma sala de bagagem com a acesso na pousa de pousada.', 'Este  um mdulo de
atualiza  o, deve funcionar conjunto com cabo Micronas OBD TOOL (CDC32XX, n 
o o trabalho sozinhos.', '116 Por isso, fazia a Deus, o verdadeiro rei; n  o
est l como Ele, Senhor do domin  nio honrvel.', 'Educa  o tecnolgica em
Arequipa', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  o   nico
fabricante de carreiras de vapor que cumprir as requisitos da USDA ex obras.',
'Institutos em Punta Cantn, Colmbia', 'Minera  o: equipamentos e acessrios
em Yugo-Zapadny okrug, Moscow', ' Preconi  o correta do servio', 'Quando
falamo a mesma linguagem  porque temos o mesmo m  e. E isso nos d
esperana.', 'vrios tipos de acomoda  es dispon  veis para seu alojamento em
Carvoeiro: apartamentos, hotis de luxo ou carvoeiro barato, e tambm cama \&
pequeno-almoo.', 'Os fa  es em rela  o eis s  o gravados no dia 38 e 39 de
Ticu. Verso 8 do cap  tulo 38  direta a Israel, e leis:  Depois de muitos
dias ser visitado, nos   ltimos anos vir na ', 'A Casa tornou-se
imediatamente lugar de cult e em torno de ele desenvolveu o mdio Loreto: a
parede incr  vel projetada por Antonio da Sangallo il Giovane estive erected em
1518, e reforada com quatro fundamentos', 'N  o havia outro poder por que
poderia ser entregues.', 'Qualidade  um objetivo para ns e estamos sempre
buscando caminhos/redes para ajudar a entregar o melhor.', 'A forma foi focada e
entrar. Razi:', 'Embora n  o  completamente certo, muitos chefes brasileiros
concordam que a picanha cortida ao Rio Grande do Sul, a estada maior do Brasil,
famosa por Seu churrasco.', 'A condi  o de aceita  o completa em cada hora
no processo de corre  o da oferta de venda significa que apenas o primeiro
bloco ser programado de uma hora espec  fica se n  o seja completamente e
todos os blocos nesta hora ser  o ', 'Agora Davi, filho de Jesse reinou sobre
todo o Israel.', 'O raz  o de pensamento e os pensamentos no processo com fazer
decis  es.', 'Em outros fragmentos evangelizais, Jesus refere-se  falta de f
de seus seguidores.', '3 Jesus, saber que o Pai tinha dado todas as coisas em
suas m  os e que ele foi de Deus e foi  Deus;', "Como jogar Peppy' s Thandie
Newton Vestir:", 'Fabrica  o de artigos roupas{\ldots}', 'Os valores do parmetro
variam de 0 a 200\%.', 'Downloads de software relacionados com a Extens  o de
Ficheiro RB:', 'Estados contratados podem recusar a reconhecer o diabo ou a
separa  o legal se ela  incompat  vel com uma decis  o anterior
determinando o status matrimonial dos cnjuges e a essa decis  o foi obrada no
Estado em que  solicitada a', "Ao pr com uma localiza  o ao Grand Place, no
centro histrico de Brussels, o Ibis Brussels Off Grand'Place oferece um acesso
direto ao aeroporto internacional da esta  o ferroviria.", 'O mapamento
energtico descobri todas as perturba  es geologias de underground, perturba
 es a que foram usadas para beneficiar as lugares e aumentar grandemente o seu
n  vel de energia.', 'Malaria O que voc pode fazer', 'A PLEASURE do santo S 
o Jos Aquinas ou o SECONDO A  RINO OLIVA do DOMINI  O? Esperamos que o Santo
Pai, com o apoio do Esp  rito Santo, tem o poder de unir o mundo catlico, hoje
[{\ldots}]', 'Na noite, Jos, Maria, e Jesus passou um dia e a metade no lugar do
antigo Jeric, em quem Jesus  nomeado, tinha executado seus exploitos com o
judia.', 'O objetivo principal da miss  o ser trazer um mdulo russo de
Rassvet Mini Research. Este ser o   ltimo passeio do Shuttle Atlantis, e
[{\ldots}]', 'Tindo isso com epoxi, de forma a que eles n  o estavam molhadas com a
condena  o da tenda.', 'Recupera  es de Res  duos em Guavia (Camagey,
Cuba) - Amarillascuba.net', 'Nossa experincia com processos de separa  o em
refinarias{\ldots}', '(4) Nossas Condi  es Geral de Compra tambm se aplicar  o
para qualquer futuros rela  es de negcios com o fornecedor.', 'No km 31, os
verde intensos dos fluxos de sepultura  colora  o e comea a cruzar o limite
do sul da variedade montanha do vent, com uma forma  o montanha do endereo
Norte, tem seu fim norte para o vulc  o Domuyo.', 'Corte de uso   nico feito
de tecidos da posi  o 5603, de um tipo utilizado por procedimentos cir 
rgicos 6307 90 92', 'H 6 dias 10:01 XCafe sexo oral, peito, cozinha e c  o
caseira, madeira, ejacula  o, germanas, milf', 'Exceto de 120 sacerdotes jogou
trompas da consagrada do templo de Salom  o.']
tensor(21.3075)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(20.8351)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{my-decoder}{%
\subsubsection*{My decoder}\label{my-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}k}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{k} \PY{o}{=} \PY{l+m+mi}{5}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{False}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['De este modificand e posetuar-l para que as libertes da Toletura aula de
resposta. O tempo nele est pos  venvel e que aconhecido e tornar ato que
ascdi  nior para se posir por si a tolerveiser. E, deste maneiro seja um', 'e
8/2008. Winnipeg.Candulo, Candor 8 de agosto 1/10/08/2012 (Id. de 1999) 18/10
de Agora) 27:8800 a 8 de outuplo obtera-tia o aconto da cu-deabro. 8:00 -
Amrico do Canada) 24/8 de ', 'No Misteria do Primito de Deputador de Natal que
se manifestar-a pesa ilumina  a sopra o cinta daquelia em centrios de
Clculus. E se esperando-no deste cinco de C  rebro conscionnico. O que foi,
por exedem, o nosc  rcules.', 'para fezveil de corrigare dos navi  ns novas
doeste da clie.olha-n  o do ladr  n aqui, para que forja um dos outros. Olham
olhosos.. Ole  olhadamente, dep{\ldots} Os dedicadore  um dois', 'Seuse seus
Oculhos estiveva brilhanta, sendo ela se a su   opinia, deleto com um fel 
stio com as seu perd.. eu est de suprimir-teom. - A sua peitura esta f de
cl{\ldots} Ele estendei os meuo', 'Acusta, o espord  ficco, insacndico, defise
aos cu negroso dele e deprimo depila, deprimia, deprimo nenhum ec  brico
depress   e aos comentos a sepulse, abusio, des', 'Oa luminidad  com HPMaxix 
agel com lumionidad  a do defesa do limpo do ts vitals de garras, por defeio
a dois dedenos. O lumiona  esfacionar de 35\% gel de ol  dul  luminerm de
eficsc  e', 'Lmpago - De o P - ID e de o fiquel. a qual acabo. E dep  sito
de estoque, isaquecedura o P\&ID. Em tocando estar  e de oplia.se. O n de e
elh  e, Izole como para', 'A pea desce de Manas, Capital de Este est de s
amazoneio que prosperea destaque e ondo se aproxime um efl  bridor da opera
House de Paris em Paris de France: estender  a mais especufeio com a maior
detrada de 3 ou mais de queatros per  es dia de pedra', 'Atravam do sepulto n 
vel a trandeu 9/11 atenso em abero se apontaria de o municional atendidos e,
para ism com que, se fesse buscadas da realidad e que as feitadoreais,
identificados ou mantidos para um conte.. e os autorento se referin', 'Aloja,
Cois worth, constitui-a  de sua firma independente que donde nos, e a minhas p
 ncula nebra de companhas a sujeira. deste tipa, Coado de Cooworth, esto que
devemos participaremos por sui pac  a de nos esporte de companha a nos', 'Mas
este est que evitedor, que se infiltratione subafilamentas o inferenciador de
aina de um. dedo o seu modifico de um sen  culio.. E se podendor em brechasa..
O inpirador.    -tas:: 220.com/', 'Titulofof  nea   lg. Tipe de publico:
Literatura.obvie de publiciptica e especial.oma-dres.):liboografia -
biblioografia a   ri.) Tipos especricus   ltimino : Bibliografia em
ingleso.', 'A Modificat  o de programmo descrit  : is algormos com o V  nfa
v  rus W2B/F ou fod v  nrus de vdo W32/Ab.W, programam de gerio, podem obtar
um program de software, incluinda um desfrutando de alterveisse e as opera',
'Naquelis dese casa, Joger M a media QuickTime acompanha operacionando
funcionisma sofre do video MOv e os algun atras  dico.. O Quicktime.net esfro.
- Amorador com assinatura de obra{\ldots} escritricas - Ambre como', 'El f com
actual o encerramenta professor da Science Policy da Unidpia do Barco
University Pombo Fabro de Barrana a DuckSeque. O professor de Baratos, no Barca
2010-2007.net n  O.com. (Gran) de Apocidade Po  tic, professor de CII). O
Professor da Criancial', 'Adesionvel decosmtico, quem poder  a pequeizar-lhe
como dados.- - Amlibus.  .A., odocento colicco, por em seus comido,m, poder,
para que assuntesnebrasidas adicvei. Ad', 'Comemoramos sobrirrado de
prefmiodicias de efaito de prserval - Guia.orgia e   rea - Guia-Ru 
dielinhas-devivm test de cobranosliulas-da.comenu.aspr.', 'Por com isses voca
conser ter n  o permitidos, de estudar um desde o minhas habilite  sua
extercito em minhas autorrec.e acert-lagado? E encontre-me.o - Obti 
necdicianada uma proprio aprove', 'Obtende interven n  meri da USA aos leitor
n ol  ncipento{\ldots} Aqui.comg.com.a.lpcidos adota   n l   n  merios da EUB,
os larom  s. Ao longa olham um poucorrer', 'Nbecya, que prov-a, por outuplo
de 40 forneces de fornos e a prontomas com muit  meros recurso s de 60, que
seriam por mais grande e de maioria a frniznizniz de fuso elargargido
mundeiamente, de forones de pro', 'Deve-a famo eis esta que a atribu  nes qu 
nulica de "lementivo"!. Os horados n  meros da prprii organizacional..o com
escolha de prov. -lb aps-famos.-foi.como', 'Exame de Especialist  e, -
coordination das equipele  o elei   senhadura de testeira independent para
analises do trao de ensaimente environnemento complexe e.. E.U, coelaborandO,
as treinamencia das echipes da Elaboro ambientalisma, para exame independente
como v  rus, coel', 'H  o al com um sal remoto para cintura e fortalecem, no
poumo, para casa. O seu pouco e um vareja da poupanaria estar ao aluna de
alomanham a partir do hostel, de casaslhos. Aintados h cozinham.com. (Sal  )m)
para al', 'Ist sem software da software aind , preciso operar associar os
cable a OBS ODB Tol. Id. apena de 2XX).soslinhados. -   lbb..m   bc..ms de
moduso.se.com a Micron S  ', '106 Porventue, poire-so Allah a tutore Rei. Seu
defcile est algo por issa que Ele o reis o digorado domininior. O Santuario os
deuseiros n  o foi um desejveis; para todas assinal, deus verdeve ningem
deuse', 'Aduc tpico no Istquipa n.o, cdigo em Doradoclicas, cidades
industrialian. Av aput eu.c.a p - GuiamSeguirSanet.com B.Joro adirgico.
Tco', 'Dizimos de Ao levanto: Marc  o - Concluto exteriorlhe -te de pesade do
tradicionistas: Messanaco.co.com (Mosuid).com detalhado) Dictios de negronivos
de Amarca.com/Diocese   o ar livre ao mercador', 'O AVAMAG, um dois fabricanto
de embalagen  uma das exigentee  vedul  da da USA ex funciona de operas.. A
Vejam  a o que aditar. A VEmag  nio est como esfora da FMI, seguador com
necerto os AUSS. Os', 'Irrejo: institute, engenheiramente da estudo, peraria -
Risco a ira de Corredo (Arab, Bole  ) e da Guada, col  via elicina de corrent
e efeitu  sos.sanitaregid  e, Colgico), Institut', 'Minerada : artific 
aica: vendas az  os, cinosis: pse-pie, mochibamba, Mosqusa. Amavano da
artificifica?az.e, Yuvo, Ocatelcis, aquados, cincos.a.ca{\ldots} \& consult',
'Servinduras precis  veeis a um atendiciae de servia 2 -   b.  Aprovadura
de um servimente  cidos do Servinta   Boas-Fecho  e  A prestntica de
atendedoriamente do servimentamentlbum n.a.', 'Em segr se referem-ne para
escrit  o da mea melhor, porque, t  as da praga mesmas, que estou o quer. O
segurosso, se deve-lh. aquilo,, por cintu, porque, estando a t  nis.. E o que',
'.Vieinos especiments para seul movidor en carviinho: alojes para alma, hoteis
barcaros de carval  o; hots acesto para carveira; o aldeio de aldeixe de camas
ou pes-des-chaves-almas{\ldots} e eunegron', 'Propereia a isto registranada e nos
39a seguimento do Escekiele, versamente aos tereto, no Vers  tria 28 do capio
39 do Capt  tula 38 do Cap  tulo 39 sabe: Depor e v  e sair, ti seres ano: no
 leu', 'A Repe s  a um cinco a um, a um tomnou imediatement nele assunrdicos
mdio-vale, da murale impressionant  veis eprovada e aindel Giov foi intarado
por 18 a ressornand com quate apendidos no diris do', 'Aindo havide mais um
pode, de aquila de que conseria-lh-los de entreg. A ele apresenteu como o
ninglmiolmento os seus. E. Aquilcidos. Aquilamente, se a tudade{\ldots} Ao na
cin', 'Qualide nos ser temo com que de mano que procura-na de forma de
camisagemos/ef  to para que-os as destacam o que noss  vem..m.net.o em quem
para, poderiam-ser-nos melhar.. AQue  de quem tem-ser com um desequid', 'As
formalidada se se deu-tinham tomadamente detalha, delei::m, destaque,m, eu seu
arritid  do a seus arco, de cimentrdica, delei. O ri: o que foi destacar.,
deleito{\ldots})io', 'O mais faz-na menos certes muis colegera do brabil convereram
que as correnteira da fotolanca est no Rio Grande da Sul, da estanda mais leita
pele suas peadas, que est   sob si membu fechadiana, que foi um desde que mu
 e{\ldots} Efacionalmente', 'Conhecer uma condenada com o plstio no tempo n  or
da aprovar do processar da candidat   com vendena do primo bloco de oferta,
significar de n  O programarem um sem um momenta determinante para sem ela
efinamente e todeis as obstru  sso para um quadrante para', 'Agedamente 
disto o seu filha da Jeesse rebanha na total do Israel com sede de s de Israel.
apnda. O seu adversrie  um dessas coais n.m.m. n.h.m, no fundia de Deus de
Deuter ', 'O queramente tem do processar com as decissmico, no que permitem um
reagenc  nuo mentiro do csus, no processar de acionista de adecintos, do cora.
aos decr..o.,m eu, por favor.o aprovetou.o tem', 'No outrito f  gado de emg 
os as semelho Evangelistais referena para falha para de fica daquelia do
segistria, seguidores seguin e seus olhos espiridos; de outra forma com que seu
ef  cios, Jesus refera para falha. A fsi', '3. Em Jesus contemplatindo, de que
com Deuteriam o ps s segunda saber de que, para a Deu ao seus meo; e foi
dedela; de vinte dele, como se deus a em tud. - Amarilla, de Depute.-sa  de:o',
'Coma Joga jogam O Jogadore do Papper santua Newton vesting up, dourado o pau da
ta{\ldots} A edificar op  ada por papel - Guianque.orgt detalhados para pausar
dep-dito de pauso e de um bosto da vest', 'Fabricate da marma de bebidados com
cenar. agr{\ldots}gner   ltimo de cortigna: info de correi.com/Feitura de
corredores de p{\ldots} Pt{\ldots} A adversar.net |t - p  osat', 'Os valeis da pea
difere com a partir do parmeter de 00 para 80\%. As valorizas destaques de cada
parmero.   tamos.o naviu de 2000\% ao na qual nen  nimos. o valor  de 20\%
aqui.odo por uma per  or.', 'Baitando - Baita software com coma A DR - com as
vers  ulis. BR:slados e navio. Adverss: efetual,tegnrgio, fifieiro: Download
adiativotate: download para arqueo n.', 'O estatoniste concorride de se negar
recusande uma sepult  cissido de divid  o e separi  o de sao incompreen 
veis pesar  decisrbio precedente determinar seula materna a fosse realizadas,
mas que seja fazio doestde de ni', 'com loca  O superior,  timidadE de Gr 
n ao leico dos Emirados Estabelimos, e da leo em B  nfa ao Aeronais.  
Ibb. Bruxelles, a GrandePlato possitem desta octe para um rea transporteiar.
Esta', 'Cart  ele de Energie detraz toda das turbulecciais da geoologiia
underground. atrasados para ao seguador dos estabelabelimos para autcar do
lugar, autntica de tlcool delerado a tomadamente com seus graus a e eletrompa
ao lar do', 'Maquinrios Aquiliso que Vou ficarm. O santa da sujeira da Amlcica
Oquivoca de Fbrica elcter advencedas da su  a da Malra. A de um desenhar de
alcnimas. Aproximado aquiler na Malaria que Voca', ' necosite que um pobreza o
Srebro do HOMOMISSIO, Jos Pedro Agrin   OU S  OS DE DIOS AD  RINO A OLIV
MINICIA? A. Esperia-terem de ser um povo para uniti-ser tornands{\ldots} A
qualqueram s  em pelO Sano P  s, sem assist', 'Nestea tera deste detinha
Jos-Mer  a, que Jesus tinha o cambalo e para o local de Je  so Antiga ondes
Jo  o, pesa quer e a queMai foinomo Jesus dep  ito como seu conduzindo,
seguver da tecnomia de judt', 'Objecionar  a o lmpadra dos seus fundas, que
se traz  e para tornou uma o s  mulo Ruses momboleo Rassesvt miniaquisto. Ese
foi um desejo de{\ldots} A fce a partir da fam  lcima tripulare de Atanti e{\ldots}
O{\ldots}', 'Ele pinto-sele de um esplice para com conduora a visha deleto n 
oferoa para um depoi a fosse um acomido, para que, segunto-l, condunio da
tenttia. O corta-lhe. Apresenteis ess  e o p', 'reabilitec  c  o de lixo
para Santa Plati, Guavia  Agriturismu.com.ca (Bama, Cuba), Cuba). Agros de
artiquim egrficastuoslgia, La Altovar (Santirbios, Guamivn, Cusco   stica)
Aragu  e', 'a Our experiente de Processo de dividncie no{\ldots} Ao   lembnuo.net
com{\ldots} Eleinicas da Lu  a (Brey) |g) | Frum consultores especmico s 
rbiostac.como um avprios{\ldots} e em Corta', '4 Noa condensidado geradi de
comprito se solicitarei para todes as conjuntamente de aconto a quer o que as
empregos nen  veitamente sejaja present apresentaor no promotor,
depoissemos.sa.obter a nosstia em em conjuntot', 'No c  rmine de 21, est um
grande abracador e destaques em cor ao colorar para ele inc  mero para que
passarei do margei de Monte do   rbite de ventres, formandou um campo da ao
cidador, contendenda segestrado de um   ltero norteste, de v', 'Pinto para
Usas fechidos fetusamente e compostamente com as metas a tiquia 5602, do meto
que estebrado, no tratamenta da ocional de 607, os 90 92 com as mecpsior 
stios de 90, o sexto do usar com as m  s', 'Bair, cios de casosmbroca, casal e,
madurma, caseiro nelad, ninja a sabor de boe, mama, gargo de coro, santinhasca,
em peyutanha{\ldots} Amord acesso', 'De modo exaustante de,120 capitulados tomaras as
portos, sobre em consantidadE o Tempelamento Desavo. - O porcuna aos 12 obrada.
O dezmulos de tecidor, de 120 sacrdtes jduzidores dos teus de Saloms']
tensor(0.8399)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(0.5005)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{comparison-nucleus-sampling}{%
\section*{Comparison: Nucleus
Sampling}\label{comparison-nucleus-sampling}}

    \hypertarget{hugging-face-decoder}{%
\subsubsection*{Hugging face decoder}\label{hugging-face-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}p}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{p} \PY{o}{=} \PY{l+m+mf}{0.95}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{True}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['A vida civil desta forma destaca, faz poss  vel como um cidad  o sobre todos
os frutos de tolerncia e respeitos mutuois.', '1999 XIII. Winnipeg, Canad 23 a
8 de agosto', 'No mistrio da Natal, a luz de Cristo deu na terra, diante de,
como era, em c  rculos conc  nicos.', 'fazer a produ  o de que os dois novos
laos oestes daquela pen  nsula.', 'Seus olhos foram brilhantes e sua voz foi
felic  fica.', 'Inferi  es, acidentes, inavana, abuso, abuso, separa  o,
dana, viola  o, horroagem, enbito, depress  o, ansiedade, alimenta  o.',
'A branque a HP Maxx  um gel de clareamento de hidrognio de 55\% a clarifica 
o dos dentes vitales e n  o vitais.', 'Linhas: com indica  o do n  mero da
linha, D e ao longo, isolamento do P\&ID onde elas s  o tirados.', 'As viagem se
adrem de Manaus, capital do Estado do Amazonas, uma cidade na floresta na
floresta que prosperou durante o boobo ve  culo e onde voc ir encontrar uma
cpia mais pequena da Opera House, de Paris, na', 'Os traz  es terroristas ao
abrir as suas atacadas garantiram que foi dada de aten  o pelo mundo, e a
verdade ser buscada e os atentantes identificados e possado a conta.', 'Like
Williams, Cosworth  uma empresa independente cuja propriedade partilha nossa
paix  o pela corrida e engenharia.', 'No entanto, isso pode ser evitado se
infiltra  o  subepithelial.', 'Tipo de Publica  o Portugus: Bibliografia',
'Modifica  o de programas:   s vezes, v  rus v  rus:Win32/Deprend.F ou
malware SWiJ SideWinder mas tambm softwares comuns tm a capacidade de
modificar as fun  es internas do FXUCU001.DLL, o que significa que outros
programas n', 'Em alguns casos, o jogador da media QuickTime est a ficar operac
 o do v  deo MOV devido a alguns problemas de corrup  o.', 'Ele est a
professora de Cincia Pol  tica da Universidade Pompeu Fabra em Barcelona.',
'As aditivos cosmticos n  o devem perper.', 'Comentrios para teste de
preservativo da Estrada', 'Como eu obti uma extens  o de minha autoriza  o ao
estudante?', 'Apena de interven  o dos EUA em latino!', 'Nabertherm com 450
funcionrios em todo o mundo s  o se desenvolvido e produzindo fornos
industriais para muitos caseiros de mais de 60 anos. Como fabricante, Nabertherm
oferece a larga gama de fornos.', "Termos esses qu  micos de 'elementos'.", 'A
Revis  o Especial  coordena  o de equipes especialistas selecionados para a
avalia  o independente de estudos ambientais complexos.', 'Alm do est o
pequeno quarto de armazenamento de bagagem dispon  vel no no depsito.', 'Este
 um mdulo de atualiza  o, precisa funcionar conjunto com cabo micronas OBD
TOOL (CDC32XX), n  o pode funcionar sozinho.', '116 Ent  o  a Deus, rei
verdadeiro; n  o est l, mas Ele, Senhor da domini  o honrvel.', 'Educa  o
tecnolgica em Arequipa', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A
VEMAG  o   nico fabricante de acessrios de p que cumpri com os requisitos do
USDA ex trabalhos.', 'Institutos em Risaralda (Risaralda, Colmbia) Faculdades e
escolas em Risaralda', 'Minera  o: equipamentos e suprimentos em Yugo-Zapadny
okrug, Moscou', ' Proprecia correto do servio', 'Quando falamos a mesma
idiomassima  porque temos a mesma m  e. E este nos d esperana.', 'Vrios
tipos de acomoda  es dispon  veis para o apartamento em Carvoeiro:
apartamentos de luxo ou hotis de carvoeiro baratos e tambm cama-de-manh .',
'As profecias sobre este s  o gravados no dia 38. e 39o capitulo da Ezequil.
Verso 8 do cap  tulo 38  abordado a Israel e l: Depois de muitos dias te
encontrars; nos   ltimos anos, em terra que vo', 'A Casa imediatamente se
tornou lugar de culto e em torno deles que estabeleceu a raio medieval: a
murhada imponente projetada por Antonio da Sangallo il Giovane foram erradas em
1518, ereforau-se com quatro bastinas em', 'N  o havia outro poder pelo qual
poderia ser entregue.', 'Qualidade  uma necessidade para ns e estamos buscando
sempre, caminhos/mecinhas para nos ajudar a entregar os melhores.', 'A forma
tinha se tornado cima e divertida. Rii:', 'Embora n  o seja certo, muitos chefs
brasileiros concordam com que a picanha cortada do Rio Grande do Sul, o estado
mais do lado do Brasil, famoso pela seu churrasco.', 'A condi  o de aceita 
o completa em cada hora no processo a ajuste da oferta de venda significa que
apenas o primeiro bloco ser programado em uma hora espec  fica se n  o 
conforme completamente, e todos os blocos nesta ', 'Agora Davi, filho de Jesen
Reinou sobre todos os Israels.', 'O raz  o e os pensamentos do cus no processo
de seguimento decidiente.', 'Em outros fragmentos evangelizados, a mesma Jesus
refere-se a falta da f dos seus seguidores.', '3 Jesus saber que o Pai estava
dedicando s suas m  os, e ele foi de Deus e tornou-se a Deus;', "Como jogar o
depsito peppy's Thandie Newton Dress Up:", 'Manufacture de artigos de
couro{\ldots}', 'Os valores do parmetro variam de 0 a 200\%.', 'Downloads de
software relacionados com a extens  o de arquivo RB:', 'Os Estados contratados
podem excluir o reconhecer um divorce ou separa  o justo, se estiver incompat
 vel com uma decis  o anterior determinando o status matrimnico dos cnjuges
e que sua decis  o seja feita no Estado no qual o reconhecimento est procura',
"A Htel hotel de Excelente est feito com uma localiza  o melhor no Plaza
Grand e no centro histrico de Brussels, o Ibis Brussels Off Grand'Place oferece
um acesso direto  esta  o ferroviria do aeroporto.", 'Maquina energrica
descobrir todas as perturba  es gelogos subterrneos, perturba  es que
foram usadas para beneficiar os locais e aumentar muito o seu n  vel
energtico.', 'Malaria O que Voc fica', 'O SECONDO de Santo Thomas Aquinas OU o
sexto OLIVA do DOMIN  O?. Esperamos que o Santo Padre, com a ajuda do Esp 
rito Santo, tem o poder de unir o mundo catlico, hoje [{\ldots}]', 'A t  o noite,
Maria e Jesus caminhou um milho, e a metade ao local do antigo Jericgico, onde
Josu, por quem Jesus foi nomeado, realizau suas exploitas com condu  o de
acordo com a tradi  o judicana.', 'O principal objetivo da miss  o senareis a
trazer um mdulo Russo Rassvet Mini-Research. Este ser a   ltima viagem do
Shuttle Atlantis e [{\ldots}]', 'Estavam molhadas com a condena  o da tenda.',
'Recupera  o de Res  duos em El Morazn (Fima, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separa  o nos refinarias{\ldots}', '(4) As
nossas condi  es gerais de compra tambm requer rela  es comerciais futuras
com o fornecedor.', 'Em km 31, os verde intensos dos fluxos escontem-se at a
colora  o e comea a cruzar o limite do sul da gama montanha do vento, com
forma  o montanhas de direito  norte, tem o seu extremo norte para o vulc  o
Domuyo.', 'Acade de uso   nico com composto em tecidos da posi  o 5603, de um
tipo utilizado durante procedimentos cir  rgicos 6307 90 92', 'H 6 dias 10:01
XCafe punha boleia, brinquedo, bunda caseiras, casada, ejacula  o,
esporradela, sexo oral, esporradela', 'A excepcionalmente, 120 sacerdotes
tocaram trombontinas na consagra  o do Templo de Salom  o.']
tensor(21.3211)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(21.0985)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{my-decoder}{%
\subsubsection*{My decoder}\label{my-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model}\PY{o}{.}\PY{n}{decoder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top\PYZhy{}p}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{model}\PY{o}{.}\PY{n}{p} \PY{o}{=} \PY{l+m+mf}{0.95}
\PY{n}{model}\PY{o}{.}\PY{n}{hugging\PYZus{}face} \PY{o}{=} \PY{k+kc}{False}
\PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{n}{trainer\PYZus{}decoder\PYZus{}comparison}\PY{o}{.}\PY{n}{test}\PY{p}{(}\PY{n}{model}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{verbatim}
HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Testing', layout=Layout(flex='2'), max=
    \end{verbatim}

    
    \begin{Verbatim}[commandchars=\\\{\}]
('In this way, the civil life of a nation matures, making it possible for all
citizens to enjoy the fruits of genuine tolerance and mutual respect.', '1999
XIII. Winnipeg, Canada July 23 to August 8', "In the mystery of Christmas,
Christ's light shines on the earth, spreading, as it were, in concentric
circles.", 'making it viable to drill two new boreholes in the west of that
peninsula.', 'His eyes were shining and his voice was cheerful.', 'Injuries,
accidents, bereavement, abuse, separation, shock, rape, bullying, harassment,
stress, depression, anxiety, eating.', 'Whiteness HP Maxx is a 35\% hydrogen
peroxide whitening gel for the whitening of vital and non-vital teeth.', 'Lines:
with indication of Line Number, From and To ends, insulation, the P\&ID where
they are drawn.', 'The cruises depart from Manaus, capital of the State of
Amazonas, a city in the jungle that prospered during the rubber boom last
century and where you will find a smaller copy of the Opera House in Paris,
France. There is a choice of a three or four days cruises, both of which include
the Meeting of the Waters, where the Rio Negro and the Amazon River
converge.', 'By bringing 9/11 out into the open they ensured that it was given
worldwide attention, and that the truth would be sought and the perpetrators
identified and held to account.', 'Like Williams, Cosworth is an independent
company whose owners share our passion for racing and engineering.', 'However,
this can be avoided if infiltration is subepithelial.', 'Publication Type
English: Bibliography', "Program Modification: Sometimes, not only virus
Worm:Win32/Dedler.F or malware SWiJ SideWinder but also common softwares
possessing the ability to modify the inner functions of FXUCU001.DLL, which
means other programs can't find this DLL file again.", 'In some cases QuickTime
media player halts smooth running of the MOV video due to some corruption
issues.', 'He is currently Professor of Political Science at the University
Pompeu Fabra in Barcelona.', 'Cosmetic additives must not penetrate.', 'Comments
for Highway condom test', 'How do I obtain an extension of my student
authorization?', 'Enough of US intervention in Latin !.', 'Nabertherm with 450
employees worldwide have been developing and producing industrial furnaces for
many different applications for over 60 years. As a manufacturer, Nabertherm
offers the widest and deepest range of furnaces worldwide.', "We call these
chemicals 'elements'.", 'Expert Review  coordination of teams of selected
experts for the independent evaluation of complex environmental studies.',
'Thereto there is a luggage storage room provided in the hostel.', 'This is a
update module, must works together with Micronas OBD TOOL (CDC32XX) cable,
cannot works alone.', '116 So exalted be Allah, the True King; no god is there
but He, the Lord of the honorable dominion.', 'Technological education in
Arequipa', 'Andinia.com - Outdoor Dictionary: Messan', 'VEMAG is the only
manufacturer of vacuum fillers that complies with USDA requirements ex works.',
'Institutes in Pereira (Risaralda, Colombia) Colleges and schools in Risaralda',
'Mining equipment and supplies in Yugo-Zapadny okrug, Moscow', ' Correct
provision of the service', 'When we speak the same language it is because we
have the same mother. And this gives us hope.', 'Several kinds of accommodations
available for your lodging in Carvoeiro: apartments, luxury or cheap Carvoeiro
hotels, and also bed \& breakfast.', 'Prophecies concerning this are recorded in
the 38th and 39th chapters of Ezekiel. Verse 8 of chapter 38 is addressed to
Israel, and reads, After many days thou shalt be visited: in the latter years
thou shalt come into the land that is brought back from the sword, and is
gathered out of many people, against the mountains of Israel, which have been
always waste: but it is brought forth out of the nations, and they shall dwell
safely all of them.', 'The House immediately became place of cult and around to
it developed the medieval Loreto: the impressive wall projected by Antonio da
Sangallo il Giovane were erected in 1518 and reinforced with four bastions in
1600.', 'There was no other power by which they could be delivered.', 'Quality
is a must for us and we are always looking for ways/tools to help us to delivery
the best.', 'The form had become focused and funny. I laughed:', 'Although it is
not completely certain, many Brazilian chefs agree that the picanha cut
originated in Rio Grande do Sul, the southernmost state of Brazil, famous for
its churrasco.', 'The condition of complete acceptance in each hour in the
matching process of the first block of the sale bid means that only the first
block will be programmed in a specific hour if it is not matched completely, and
all the blocks in that hour will be withdrawn and not the bid presented for the
other hours.', 'Now David the son of Jesse reigned over all Israel.', 'The
brains reasoning and thoughts in the decision-making process.', 'In other
evangelic fragments the same Jesus refers to the lack of faith of his
followers.', '3 Jesus knowing that the Father had given all things into his
hands, and that he was come from God, and went to God;', "How to play Peppy' s
Thandie Newton Dress Up:", 'Manufacture of leather goods{\ldots}', 'The values of
the parameter vary from 0 to 200\%.', 'Software Downloads Associated with File
Extension RB:', 'Contracting States may refuse to recognise a divorce or legal
separation if it is incompatible with a previous decision determining the
matrimonial status of the spouses and that decision either was rendered in the
State in which recognition is sought, or is recognised, or fulfils the
conditions required for recognition, in that State.', "With a top location at
the Grand Place and the historical center of Brussels, the Ibis Brussels Off
Grand'Place offers a direct access towards the international airport by the
railway station.", 'Energetic mapping uncovers all geology disturbances
underground, disturbances which were used to benefit the locations and greatly
increase their energy level.', 'Malaria What You Can Do', 'THE PLEASURE OF
HOMOSEXUAL SECOND Saint Thomas Aquinas OR SECOND THE DOMINICAN ADRIANO OLIVA? .
We hope that the Holy Father, with the help of the Holy Spirit, has the power to
unite the Catholic world, today []', 'That evening Joseph, Mary, and Jesus
walked a mile and a half to the site of the ancient Jericho, where Joshua, for
whom Jesus was named, had performed his renowned exploits, according to Jewish
tradition.', 'The main objective of the mission will be to bring a Russian
module Rassvet Mini-Research Module. This will be the last trip of the Shuttle
Atlantis, and [{\ldots}]', 'I paints them with epoxi so that they were not wet with
the condensation of the tent.', 'Waste recycling in Santa Clara (Villa Clara,
Cuba) - Amarillascuba.net', 'Our experience with separation processes in
refineries {\ldots}', '(4) Our General Conditions of Purchase shall also apply for
any future business relations with the supplier.', 'In km 31, the intense greens
of the streams sink to the coloring and it begins to cross the south limit of
the Mountain range of the Wind, with a mountain formation of address north-
south, has their north end for the volcano Domuyo.', 'Single-use drapes made up
of fabrics of heading 5603, of a kind used during surgical procedures 6307 90
92', '6 days ago 10:01 XCafe blowjob, whore, dogging, homemade, facial, German,
milf', 'Exceptionally, 120 priests played trumpets at the consecration of
Solomons Temple.')
('Deste modo, a vida civil de uma nao amadurece, fazendo com que todos os
cidados gozem dos frutos da tolerncia genuna e do respeito mtuo.', '1999
XIII. Winnipeg, Canad 23 de julho a 8 de agosto', 'No mistrio do Natal, a luz
de Cristo irradia-se sobre a terra, difundindo-se como crculos concntricos.',
'e tem o objetivo de viabilizar a perfurao de dois novos furos no ocidente da
citada pennsula.', 'Seus olhos brilhavam e sua voz era alegre.', 'Leses,
acidentes, luto, abuso, separao, choque, violao, assdio moral, assdio,
stress, depresso, ansiedade, comer.', 'Whiteness HP Maxx  um clareador  base
de perxido de hidrognio a 35\% para clareamento de dentes vitais e no
vitais.', 'Linhas: com indicao do nmero de linha, as extremidades, o
isolamento, o P\&ID onde esto desenhadas.', 'O Desafio parte de Manaus, capital
do estado do Amazonas, uma cidade prspera pelo auge da borracha no sc.XIX, e
onde se encontra uma cpia em menores propores da Casa de pera de Paris, na
Frana. Existe a possibilidade de 3 ou 4 dias de cruzeiro, dos que s incluem o
encontro com as guas , onde o Rio Solimes e Negro se unem sem mesclar suas
guas.', 'Ao trazer o assunto sobre o 9/11 para a ribalta asseguram que seja
dada ateno mundial, e que a verdade seja pesquisada e tida em conta.', 'Como
a Williams, Cosworth  uma empresa independente cujos donos partilham a nossa
paixo pelas corridas e engenharia.', 'Contudo, isto pode ser evitado com uma
infiltrao subepitelial.', 'Tipo de Publicao Ingls: Bibliography',
'Modificao do Programa: s vezes, o vrus Virus:DOS/Clonewar\_252.C, malware
History Killer Pro e softwares comuns tm a capacidade de modificar as funes
de FXUCU001.DLL. Esta situao faria outros programas no podem encontrar este
arquivo DLL.', 'Em alguns casos, media player QuickTime interrompe o bom
funcionamento do vdeo MOV, devido a alguns problemas de corrupo.',
'Atualmente  professor de Cincia Poltica na Universidade Pompeu Fabra em
Barcelona.', 'Aditivos cosmticos no devem penetrar.', 'Comentrios para o
teste do preservativo da estrada', 'Como eu obtenho a extenso de minha
Permisso de Estudos?', 'Chega de interveno dos EUA na Amrica Latina!.', 'A
Nabertherm desenvolve e produz com os seus 450 colaboradores a nvel mundial,
desde h mais de 60 anos, fornos industriais para as mais diferentes reas de
aplicao.', "Chamamos a essas substncias de 'elementos'.", 'Reviso
Independente por Peritos (Independent Peer Review)- coordenao de equipas de
especialistas para a avaliao independente de estudos ambientais complexos.',
'Da mesma existe uma sala de bagagem prevista no albergue.', 'Este  um mdulo
de atualizao, deve trabalha em conjunto com cabo Micronas OBD TOOL (CDC32XX),
no trabalha sozinha.', "116 Exaltado seja Deus, Verdadeiro, Soberano! No h
mais divindade alm d'Ele, Senhor do honorvel Trono!", 'Educao tecnolgica em
Peru', 'Andinia.com - Dicionrio ao ar livre: Messan', 'A VEMAG  a nica
fabricante de preenchedoras a vcuo que est em conformidade com as exigncias
do USDA ex works.', 'Escolas pr-universitrio em Pereira (Risaralda,
Colmbia)', 'Minerao: equipamentos e suprimentos em Yugo-Zapadny okrug,
Mosc', ' A correcta prestao do servio', 'Quando se fala a mesma lngua 
porque se tem a mesma me, e isto d-nos esperana.', 'Vrios tipos de
acomodaes disponveis para o seu alojamento em Carvoeiro: apartamentos de luxo
ou hotis baratos Carvoeiro, e tambm bed \& breakfast.', 'As profecias sobre
este assunto esto registradas nos captulos 38 e 39 de Ezequiel. O versculo 8
do captulo 38  dirigida a Israel, e diz:  Depois de muitos dias sers
visitado. No fim dos anos virs  terra que se recuperou da espada, e que foi
congregada dentre muitos povos, junto aos montes de Israel, que sempre se faziam
desertos; mas aquela terra foi tirada dentre as naes, e todas elas habitaro
seguramente.', 'A Casa torna-se imediatamente lugar de culto e ao redor desta
se desenvolvem todas as habitaes da Loreto medieval: as imponentes muralhas
projetadas por Antonio da Sangallo il Giovane foram erguidas em 1518 e
reforadas com quatro basties, 1600.', 'Nenhum outro poder havia pelo qual
pudesse ser libertado.', 'A qualidade  primordial para ns e estamos sempre 
procura de maneiras/ferramentas para nos ajudar a entregar o melhor.', 'A forma
tinha-se tornado o foco e engraado. Eu ri:', 'Apesar de no estar comprovado,
muitos cozinheiros brasileiros concordam que a picanha foi originada doRio
Grande do Sul, um estado famoso pelos seus churrascos.', 'A condio de
aceitao completa em cada hora na concertao do primeiro lano da oferta de
venda, implica que s ser programada, numa hora determinada, o primeiro lano
em caso de ser concertado na sua totalidade, sendo retiradas todos os lanos
para a referida hora, no sendo retirada a oferta realizada para as restantes
horas.', 'Assim Davi, filho de Jess, reinou sobre todo o Israel.', 'As
reflexes e pensamentos do crebro no processo de tomada de decises da
vontade.', 'Em outros fragmentos evanglicos, Jesus Cristo mesmo lamenta a falta
de f de seus seguidores.', '3 Jesus, sabendo que o Pai tinha depositado nas
suas mos todas as coisas, e que havia sado de Deus e ia para Deus,', 'Como
jogar Peppy s vestir-se Thandie Newton:', 'Fabricao de artigos de couro{\ldots}',
'Os valores do parmetro varia de 0 a 200\%.', 'Downloads de Software Associados
 Extenso de Ficheiro RB:', 'Qualquer Estado contratante pode recusar o
reconhecimento de um divrcio ou de uma separao de pessoas se eles forem
incompatveis com uma deciso anterior cujo objectivo principal fosse o estado
matrimonial dos cnjuges, quer proferida no Estado em que o reconhecimento foi
invocado quer reconhecida ou reunindo as condies de reconhecimento neste
Estado.', "Com uma excelente localizao na Grand Place e no centro histrico de
Bruxelas, o ibis Brussels Off Grand'Place oferece acesso direto ao aeroporto
internacional pela estao ferroviria.", 'O mapeamento energtico demonstra
todas as perturbaes geolgicas subterrneas, perturbaes essas que eram
usadas para beneficiar os locais e elevar grandemente o seu nvel energtico.',
'Malria O que voc pode fazer', 'O PRAZER DE HOMOSSEXUAL SEGUNDA Santo Toms de
Aquino ou o segundo o dominicano ADRIANO OLIVA? . Esperamos que o Santo Padre,
com a ajuda do Esprito Santo, tem o poder de unir o mundo catlico, hoje []',
'Naquela noite Jos, Maria e Jesus caminharam, por cerca de trs quilmetros,
at o local antigo de Jeric, onde Joshua, cujo nome foi dado a Jesus, tinha
realizado as suas renomadas faanhas, de acordo com a tradio judaica.', 'O
principal objetivo da misso ter um mdulo russo RASSVET Mini-Mdulo de
Investigao. Esta ser a ltima viagem do nibus espacial Atlantis, e [{\ldots}]',
'Pintei com epoxi para no se molharem com a condensao do barraco.',
'Saneamento ambiental em Cifuentes (Villa Clara, Cuba) - Amarillascuba.net',
'Nossa experincia com processos de separao em refinarias {\ldots}', '(4) Os nossos
termos e condies de compra ainda tero vigor em todos os negcios futuros com
o fornecedor.ier.', 'Em km 31, os intensos verdes dos fluxos afundam  colorao
e comea a cruzar o limite sul da gama Montesa do Vento, com uma formao
montesa de endereo norte-sul, tem o norte terminar para o vulco Domuyo.',
'Lenis descartveis confecionados com matrias da posio5603, do tipo
utilizado durante as intervenes cirrgicas 6307 90 92', 'H 6 dias 10:01 XCafe
sexo oral, putas, posio de cachorro, caseiras, ejaculao na cara, alemo,
milf', 'Excepcionalmente, 120 sacerdotes tocaram trombetas na consagrao do
Templo de Salomo.')
['Desta forma, a vida civil de uma na  o fica em conta, dando-a poss  vel que
os cidad  os apreciam os frutos de aten  o e respeito reciproco.tamente seja
ent  o uma vida civil dos seus cidad  os para', '1999 XIII. Winnipeg, Canad
23 a 8 de agosto Internet com 18 de agosto Leste Pgina incndico   ltima 2088
 ltima 20 e agosto   ltima   ltima   l', 'No mistrio de Natal e a luz de
Cristo brilha sobre a terra e difundi-se, como era em c  rculos concent 
micos. uma luz de C  rculos concentricos de Redoras.greda - indere', 'levar os
dois novos ofocastos no oeste daquela pen  nsula.gar a ser paralabrado dois
novos trouchas no oeste desta pen  nsula. livro vivel na.lho seja algum, e a
oeste da pequina. peque', 'Suas olhos fizeram brilhantes e a sua voz estava
feliz.!l.ndios como queos olhos estavam igualmente e um fato. orientale m  o e
vazio. com cabo ao Cer', 'Clceres, acidentes, casos, pecado, derrama  o,
abuso, separa  o, choque, ebra  o, erojorna  o, abuso, cria  o, risco,
impuls  o, ansiedade, comida. | Jacinto ', 'Trata Praa HP Maxx  um gel de
branquear de hidrognio de 50\% delarga para o firmagem de dentes vitais e n 
o-vitais de 35\%.  cos em 220, - Setor. consultores PST h  Sar T (breve) gel
para clarea  o de dentes', 'Linhas: com indica  o do n  mero de linha, do
estaldo, isolamento, o P\&ID onde eles s  o traduzidas. o ser igualmente
relimitado.uca(liberta)acncia.', 'As cruciferias departam da Manaus, capital do
Estado de Amazonas, uma cidade, na jungle que prosperou durante o ezvoro velho e
onde voc encontrar uma cpia menor da Casa Opera em Paris, Frana, ocupando
trs ou quatro', 'Distanto sa  do para os deprimoras eles garantiram que foi
dada aten  o mundial, e que a verdade estava procurada e os inimigos
identificados e mandicados na conta. Blog 1.199 socr .ar Austrrio sobre Sri
Lanka -', 'Like Williams, Cosworth  uma empresa independente cujos
proprietrios compartilham a nossa paix  o pela corrida e engenharia.  
INIDA, Cosworth  uma empresa independente que diferem da nossa paix  o pela
nossa paix  o por Concorrncia de corrida', 'Mas essa pode ser evitada se
infiltra  o  subestilido. pre-Neutra. *Hambm este via o "Fomese". Windows
3:561415m dois m  ninos" (K\&B).:2258 - D.A.-P.', 'Tipo de Publica  o
Portugus: Bibliografia errada no Lan  ng. Publica  o
2006-2001rio))-(elabora  o) - Bol  via)', 'Modifica  o do Programa:   s
vezes, v  rus v  rus Worm:Win32/Dedler.F ou malware AKX e softwares comuns tm
a capacidade de modificar as fun  es interiores de FXUCU001.DLL, o que
significa que outros programas n  o podem encon', 'Em alguns casos o jogador de
m  dia QuickTime compromete a funciona  o leve do v  deo MOV devido a alguns
problemas de corrup  o.iante da mundo!lbequanto est  o assim grvido o
jogador de m  d', 'Ele actualmente  Professor of Political Science na
Universidade Pompeu Fabra em Barcelona. 19, exausta o professor de Professores
de Cincia Pol  tica. diante de uma primeira reconhec  o em Barcelona. O
professor de Medicina em Barcelona.sua nova website para o canal da
Universidad', 'Os aditivos cosmticos n  o devem perter.com.g. este (h.
ktagizer. zinc branco de eu. toadores lacuticos sem pesoas. uma
fabricodivel.y.com', 'Comentrios para teste de preserva  o de estrada
tipoamigosnativos de macio natural de condom.comlos de contramio de Estrada
decompanho.s, Experiente de Pres  o de Estrada de condo', 'Como eu obter uma
extens  o da minha autoriza  o estudante? estudante. estudante?em seguir de
correia?glncia encerra?)encarna-me a entrega deito? Bot  ', 'Aceita da
interven  o EUA no Latino. "escolas em Mesmo-Latim"!. tambm em uma interven
 o dos EUA em latina!. de nossas medidas.ptbaixo de tal?! momento', 'Nabertherm
com 450 funcionrios na terra, tm o desenvolvido e produzindo fornos
industriais para muitos aplica  es diferentes, como fabricante, Nabertherm
oferece a maior gama de fornos mundo.l n  mero, Nabertherm, com 450
funcionrios on', "Precisamos desses qu  micos'.sa especiaissa produ  o em qu
 mica.ho em tentado assim. (e 5) 20:05-07-17. 28:39-89.000s ele", 'Autor de uma
revis  o especial  coordena  o das equipes de especialistas selecionados
para a avalia  o independente de estudos ambientais complexos. 11:0/lbb -
2.0.0/Lbb:b November 2006 Anlise islmica.', 'Longe deste existe um sala de
cofre do cuidado. padr  o local.te a Alimentrio.com sua condi  o. momento 
noite. foi de unidade. 2007  rus suprimento.  Fof! | | Manuten  ', 'Este 
um mdulo de atualiza  o, deve operar junto com USB INHE TOOL (CDC32XX) cabo,
n  o pode funcionar de forma sozinho. AC050580000 [COMPALD], Aviso com Coopera
 o (nove) aleu B', '116 Em seguida deles seja Jai, verdadeiro Rei; nenhum deus
est ali, mas Ele, Senhor da dominion honrvel. na qualquer aspecto vida:m fim
com que n  o mesmo dizer. egundo quanto Unvel.opraz', 'Educa  o tecnolgica
em Kanno China-mailgens os senhos em Corts na Getla   ltima biblioteca em
Arequipa | Camingn.net!gn', 'Andinia.com - Dicionrio ao ar livre: Messan -
Dicionrio ao ar livre: Messan de Shanghai', 'VEMAG  o   nico fabricante de
requadores de p de ve  culo que cumpre cumpri os necessitas da USDA ex
trabalhos., not  cia com O comprimento de EC DIS. o VEMAG! com o ex.indoa.',
'Institui  es em Bol  var (Risaralda, Colmbia) Faculdades e escolas em
Simbpia   ltimo bilh  o.com', 'Minera  o: equipamentos e suprimentos em
Yugo-Zapadny okrug, Moscou com favor na minera  o pacauce -
AmarillasLatinas.net-vindas.nets finas de livro britnico', ' Disposi  o
correta do serviogada no serviote instalado, posto. feitamente. 25:24aps a
inscri  o da servio Contacte-mail mveisyanqe.', 'Quando falamos o mesmo
idioma  porque temos a mesma m  e; e isto nos d esperana. no acho ver.lenta
ejagida porque ns falamos;ar seu idioma.gidade,', 'Vrios tipos de acomoda 
es dispon  veis para a sua alojamento em Carvoeiro: apartamentos de luxo ou
hotis baratos Carvoeiro, e tambm cama \& pequeno-almoo. para trnsitos em
Carvoeiro: apartamentos, hot', 'At em primeiro, os   ltimos capitulos de a
uni  o no dia 38 e 39). Vers  culo 38 do capitulo 38 segundo  abordado a
Israel; e leis: Depois de muitos dias se visitar  o enfrentars, nos   ltimos
an', 'A Casa, inicialmente se tornou lugar do culto e em torno destaqueu o
Loreto mdia, a parede impulsionante da Antonio de Sangallo il Giovane foram
ermudada em 1518, reforada com quatro bastes em 1600.co fora da Por', 'N  o
havia outro poder pela qual podiam ser entregue.dificadas onde congem parecem
mais.jar!indo n  o h outros poderes. primeiros os onde dissuaves desbem-
tem.sto. o;s algum novo.', 'Qualidade  um obrigatrio para ns e estamos sempre
procurando maneiras ou ferramentas para nos ajudar a entregar os melhores. 03/05
- Ambulga.com o este objectivo. - Bolsa Website(02) time teacher. transporta',
'A forma tomada era concentrada e curiosa. Eu havia riu:, eu eu vinovado!i em
reunir: car em erro. m  o a bonitinho. aguas p).uguando:', 'Embora n  o 
completamente certo, muitos chefes brasileiros concordam que a pinda de
magistriaorora  no Rio Grande do Sul, o centro mais sul do Brasil, famosa pelo
seu churrasco.@gral aprofunde-famos', 'A condi  o de aceita  o completa em
cada hora no processo da compreens  o da oferta com competi  o do primeiro
bloco, apenas o primeiro bloco ser programado em uma hora espec  fica, se n 
o seja completamente elexinada, e to', 'Agora Davi, filho de Jesesse, governou
sobre todo o Israel. Excep  o da contra Isia 18:28. assim cias nunca de Jesus
renosse a todo o Israel. 25:2171, p  blico de Jesrcio a', 'O pensamento e o
pensamento no processo de fazer decis  o. Poderlo no tomada de decis  o dos
cus. - Norat:essa adua  o.. - Processo eje  o de decis  o. profess  o de
 le', 'Em outros fragmentos evangelizais o mesmo Jesus refere-se  falta da f
dos seus seguidores.glsia torne-se o mesmo Jesus.udoi o que preencha por
erros.ta ver  o como seus seguidores.', '3 Jesus sabendo que o Pai digreu para
tudo em suas m  os, e que se chegou de Deus, e foi a Deus; 0, E.B.B. 24, -
criado a Deus 2014 - Amncio. - Sankb Tfou ', "Como jogar Peppy' s Thandie
Newton vest up:?   ndice BlogGualhamB-se - Camrias maravilhosassam: Publica 
o fora aquilo em Paigo:m!ditrias em Mais - Ghana", 'Faberia de produtos de
couro{\ldots} Palavras para parceria em San Lorenzo - AmarillasLatinas.net{\ldots}Luvia
com bens da gr  o{\ldots}-te, agradecimento', 'Os valor do parmetro variam de 0 a
200\%. ni>, n  o nos excluir por sobretua. valorveis.hos 0 - 200\%. trabalho
durante os valores. TM', 'Downloads de software relacionados com a Extens  o de
Ficheiro RB: - IO Autor, server programasar.net 201202090663qentemente, Incr 
bic em elabora  o de arquivo RB:? pdf>/roupa', 'Estados contratados podem
recusar recuar a reconhecer um dircio ou separa  o legal se est incompat 
vel com uma decis  o anterior para determinar o status matrimonial dos esposo e
esse decis  o foi practicado no Estado em que reconhecimento seja aprendido,',
"A Ibis Brussels Off Grande'Place oferece um acesso direto ao aeroporto
internacional como a esta  o ferroviria do Grand Place, e do centro histrico
de Esta  o de Ferro. frente de Concordia e a in  o de sede internacional em
Toronto de Victoria e", 'A mapa elctrica revela todas as perturba  es
geolgicas subterrneas, perturba  es que foram usadas para beneficiar os
locais e aumentar bem o seu n  vel de energia. Arretecendo oa maior n  vel da
geologia e, s', 'A baaria O que pode fazer 90:87gr  o.com-lhe| Transparncias
em Mosulina 25:00-lhegelho todoca (2), O que voc pode fazer! (Procuraado',
'NITTRIA DE CONTINIDA S  O CONSA  TIA:. Hoje temos o poder de unir o mundo
catlico. hoje [{\ldots}], muito n  o vinde com a ajuda do Esp  rito Santo, tm o
poder para unir o mundo catlico.', 'Hoje Jos, Maria e Jesus se trairam uma
srie e meia ao site do antigo Jericcio, onde Josuu, por quem Jesus foi
nomeado, ofereceu seus exploitas de acordo com a tradi  o judica.  analista
naquele lugar do sac', 'O principal objetivo da miss  o ser, trazer um mdulos
de Rassvet Mini-Research, este ser o   ltimo viagem da Tubusa Atlantis e [{\ldots}]
18 - Numica mulher russa a Se n  o impedecer. trazer um mdul', 'Extra-os com
o epoxi para que eles n  o eram lavedas com a condena  o da tenda.m para
(Dire, histrico).-Hamb nas, cerveja de Tfuem. dianteiros evelips, cartada,
para que poss', 'Res  duos de reciclagem em Guajin Ocas (Francisco Pac , Cuba)
- Amarillascuba.net?: hotis em Seu campo00) ', 'Nossa experincia com processos
de separa  o em estreiterias{\ldots}slnguas em Suma Neve{\ldots} Ltd., Bastante-esporte
em Alessa +bocas em Seaman, Jill Eb; February 3/01/47xerno alimentares em', '(4)
Nossas condi  es Gerais de Compra tambm colocar qualquer rela  es futuras
em negcios com o fornecedor.sem filialdiros 4. novo estatim vez mais adaptado
s nossas condi  es ', 'No km 31, os verdeiros intensos dos fluxos enferm 
colora  o e comea a cruzar o limite do limite sul da gama de Monte, com uma
forma  o de almofa de o norte-este, tem sua fina norte para o vulc  o Domuyo.
teste', 'Tailatos do parabrar configuradas em tecido com tecidos da posi  o
5603, de um tipo usado por procedimentos cir  rgicos 6307 90 92 94m 9001/09 -
Amblicas com tipo especializados em manuten  o execucional', 'H 6 dias 10:01
XCafe clippad, jogo, madeira, caseiras, majestas, alem  o, milfasaslis
mulheresal., esporradelata, guianaca, an  ngua, portte', 'Excepcionalmente
120 sacerdotes jogam trombas na consagra  o do templo de Salom  o. A de Porto
de Salom  o.primida{\ldots} 3.3. -Joom  o., 12 padres patrocinaram quais']
tensor(11.3733)
--------------------------------------------------------------------------------
TEST RESULTS
\{'avg\_test\_bleu': tensor(12.1342)\}
--------------------------------------------------------------------------------

    \end{Verbatim}

    \hypertarget{beam-search-not-implemented-yet}{%
\section*{Beam-search (not implemented
yet)}\label{beam-search-not-implemented-yet}}

    \hypertarget{hugging-face-decoder}{%
\subsubsection*{Hugging face decoder}\label{hugging-face-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} model.decoder = \PYZsq{}beam\PYZhy{}search\PYZsq{}}
\PY{c+c1}{\PYZsh{} model.num\PYZus{}beams = 2}
\PY{c+c1}{\PYZsh{} model.hugging\PYZus{}face = True}
\PY{c+c1}{\PYZsh{} \PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} trainer\PYZus{}decoder\PYZus{}comparison.test(model)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{my-decoder}{%
\subsubsection*{My decoder}\label{my-decoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{0}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} model.decoder = \PYZsq{}beam\PYZhy{}search\PYZsq{}}
\PY{c+c1}{\PYZsh{} model.num\PYZus{}beams = 2}
\PY{c+c1}{\PYZsh{} model.hugging\PYZus{}face = False}
\PY{c+c1}{\PYZsh{} \PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{c+c1}{\PYZsh{} trainer\PYZus{}decoder\PYZus{}comparison.test(model)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{conclusion}{%
\section*{6. Conclusion}\label{conclusion}}

    Obs.: the comparison was made using only 10\% of the test data, due to
the amount of time necessary

\begin{itemize}
\item
  \textbf{My implementation:}\\
  All algorithms worked. To check this, I tested with k=1, for top-k,
  and p=0.01 for nucleus sampling. Forcing this values, is the same of
  doing a greedy decoding, making it possible to compare the exact
  translation and BLEU score of those obtained using the transformer
  lib.
\item
  \textbf{Hugging Face:}\\
  As expected, using the transformer lib resulted in lower test time.
  This happens because the transformer code is optimized.
\item
  \textbf{Comparison:}\\
  For both implementations with other values (ex: k=10, p=0.95) resulted
  in a much slower BLEU. In th=he top-k the token was sampled uniformly
  and not weighted. This could explain the BLEU score.
\end{itemize}

    \textbf{Unit test}

\begin{longtable}[]{@{}ccccc@{}}
\toprule
& greedy & top-k & top-p & beam\tabularnewline
\midrule
\endhead
parameters & ----- & k=1 & p=0.01 & -----\tabularnewline
BLEU & 22.6276 & 22.6276 & 22.6276 & -----\tabularnewline
\bottomrule
\end{longtable}

    \textbf{Comparison}

\begin{longtable}[]{@{}ccc@{}}
\toprule
decoding strategy & hugging face & my implementation\tabularnewline
\midrule
\endhead
greedy & 19.2643 & 22.6276\tabularnewline
top-k (k=5) & 20.8351 & 0.5005\tabularnewline
top-p (p=0.95) & 21.0985 & 12.1342\tabularnewline
beam-search & ----- & -----\tabularnewline
\bottomrule
\end{longtable}

    \hypertarget{end-of-the-notebook}{%
\subsection*{End of the notebook}\label{end-of-the-notebook}}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
